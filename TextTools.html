<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>TextToolsã€Šï¾ƒï½·ï½½ï¾„ï¾‚ï½°ï¾™ï½½ï¾ã€‹- ãƒ†ã‚­ã‚¹ãƒˆå‡¦ç†ãƒ„ãƒ¼ãƒ«é›†</title>

<link id="favicon" rel="icon" type="image/svg+xml" href="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NCA2NCI+CiAgPGRlZnM+CiAgICA8bGluZWFyR3JhZGllbnQgaWQ9InRleHRHcmFkIiB4MT0iMCUiIHkxPSIwJSIgeDI9IjEwMCUiIHkyPSIxMDAlIj4KICAgICAgPHN0b3Agb2Zmc2V0PSIwJSIgc3RvcC1jb2xvcj0iIzAwNzdjYyIvPgogICAgICA8c3RvcCBvZmZzZXQ9IjEwMCUiIHN0b3AtY29sb3I9IiMwMGZmY2MiLz4KICAgIDwvbGluZWFyR3JhZGllbnQ+CiAgPC9kZWZzPgogIDxyZWN0IHdpZHRoPSI2NCIgaGVpZ2h0PSI2NCIgcng9IjEyIiBmaWxsPSIjZjVmNWY3Ii8+CiAgPHRleHQgeD0iMzIiIHk9IjQ2IiB0ZXh0LWFuY2hvcj0ibWlkZGxlIgogICAgICAgIGZvbnQtZmFtaWx5PSJCYWhuc2NocmlmdCwgJ1NlZ29lIFVJJywgc2Fucy1zZXJpZiIKICAgICAgICBmb250LXNpemU9IjM2IiBmb250LXdlaWdodD0iNTAwIgogICAgICAgIGZpbGw9InVybCgjdGV4dEdyYWQpIj5UVDwvdGV4dD4KPC9zdmc+Cg==">

<style>
:root {
  --bg: #f5f5f7;
  --surface: #ffffff;
  --surface-raised: #f0f0f2;
  --border: #d0d0d8;
  --text: #1a1a2e;
  --text-muted: #666680;
  --accent: #0077cc;
  --accent-glow: rgba(0, 119, 204, 0.1);
  --delete: #d63031;
  --delete-bg: rgba(214, 48, 49, 0.12);
  --insert: #00a86b;
  --insert-bg: rgba(0, 168, 107, 0.12);
  --change: #e67e22;
  --change-bg: rgba(230, 126, 34, 0.12);
  --grid-color: rgba(0, 119, 204, 0.05);
}

[data-theme="dark"] {
  --bg: #0a0a0f;
  --surface: #12121a;
  --surface-raised: #1a1a26;
  --border: #2a2a3a;
  --text: #e8e8f0;
  --text-muted: #8888a0;
  --accent: #00d4ff;
  --accent-glow: rgba(0, 212, 255, 0.15);
  --delete: #ff6b8a;
  --delete-bg: rgba(255, 107, 138, 0.15);
  --insert: #7dffb3;
  --insert-bg: rgba(125, 255, 179, 0.15);
  --change: #ffcc4d;
  --change-bg: rgba(255, 204, 77, 0.15);
  --grid-color: rgba(0, 212, 255, 0.03);
}

[data-theme="sepia"] {
  --bg: #f4ecd8;
  --surface: #faf6eb;
  --surface-raised: #efe9d9;
  --border: #d4c9a8;
  --text: #433422;
  --text-muted: #7a6a50;
  --accent: #8b4513;
  --accent-glow: rgba(139, 69, 19, 0.1);
  --delete: #a0522d;
  --delete-bg: rgba(160, 82, 45, 0.15);
  --insert: #228b22;
  --insert-bg: rgba(34, 139, 34, 0.15);
  --change: #b8860b;
  --change-bg: rgba(184, 134, 11, 0.15);
  --grid-color: rgba(139, 69, 19, 0.04);
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  background: var(--bg);
  color: var(--text);
  min-height: 100vh;
  line-height: 1.6;
}

body::before {
  content: '';
  position: fixed;
  inset: 0;
  background-image: 
    linear-gradient(var(--grid-color) 1px, transparent 1px),
    linear-gradient(90deg, var(--grid-color) 1px, transparent 1px);
  background-size: 50px 50px;
  pointer-events: none;
  z-index: -1;
}

.container {
  max-width: 1400px;
  margin: 0 auto;
  padding: 24px;
}

header {
  text-align: center;
  margin-bottom: 24px;
  animation: fadeInDown 0.6s ease-out;
}

@keyframes fadeInDown {
  from { opacity: 0; transform: translateY(-20px); }
  to { opacity: 1; transform: translateY(0); }
}

h1 {
  font-size: 1.8rem;
  font-weight: 700;
  letter-spacing: -0.02em;
  margin-bottom: 8px;
}

h1 span.tool-name {
  background: linear-gradient(135deg, var(--accent), #00ffcc);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
}

h1 span.katakana {
  font-size: 1rem;
  color: var(--text-muted);
  -webkit-text-fill-color: var(--text-muted);
  margin-left: 8px;
  font-weight: 400;
}

.tagline {
  color: var(--text-muted);
  font-size: 0.9rem;
}

/* Theme selector */
.theme-selector {
  display: flex;
  justify-content: center;
  gap: 8px;
  margin-bottom: 24px;
}

.theme-btn {
  width: 32px;
  height: 32px;
  border-radius: 50%;
  border: 2px solid var(--border);
  cursor: pointer;
  transition: all 0.2s;
  padding: 0;
}

.theme-btn:hover { transform: scale(1.1); }
.theme-btn.active {
  border-color: var(--accent);
  box-shadow: 0 0 0 3px var(--accent-glow);
}

.theme-btn.dark { background: #0a0a0f; }
.theme-btn.light { background: #f5f5f7; }
.theme-btn.sepia { background: #f4ecd8; }

/* Tool selector tabs */
.tool-tabs {
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
  margin-bottom: 24px;
  justify-content: center;
  animation: fadeIn 0.6s ease-out 0.1s both;
}

@keyframes fadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}

.tool-tab {
  padding: 10px 18px;
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: 8px;
  cursor: pointer;
  font-size: 0.85rem;
  font-weight: 500;
  color: var(--text-muted);
  transition: all 0.2s;
}

.tool-tab:hover {
  border-color: var(--accent);
  color: var(--text);
}

.tool-tab.active {
  background: var(--accent);
  color: var(--bg);
  border-color: var(--accent);
  box-shadow: 0 4px 15px var(--accent-glow);
}

/* Main layout */
.main-content {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 24px;
  animation: fadeIn 0.6s ease-out 0.2s both;
}

.main-content.full-width {
  grid-template-columns: 1fr;
}

@media (max-width: 900px) {
  .main-content {
    grid-template-columns: 1fr;
  }
}

/* Panels */
.panel {
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: 12px;
  overflow: hidden;
}

.panel-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 12px 16px;
  background: var(--surface-raised);
  border-bottom: 1px solid var(--border);
}

.panel-title {
  font-size: 0.8rem;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.05em;
  color: var(--text-muted);
  display: flex;
  align-items: center;
  gap: 8px;
}

.panel-title::before {
  content: '';
  display: inline-block;
  width: 8px;
  height: 8px;
  border-radius: 2px;
  background: var(--accent);
}

.output-panel .panel-title::before {
  background: linear-gradient(135deg, #00ffcc, #00d4ff);
}

.panel-actions {
  display: flex;
  gap: 6px;
}

.panel-body {
  padding: 16px;
}

textarea {
  width: 100%;
  min-height: 300px;
  background: var(--bg);
  border: 1px solid var(--border);
  border-radius: 8px;
  padding: 12px;
  font-family: 'SF Mono', Consolas, monospace;
  font-size: 0.9rem;
  color: var(--text);
  resize: vertical;
  transition: border-color 0.2s, box-shadow 0.2s;
}

textarea:focus {
  outline: none;
  border-color: var(--accent);
  box-shadow: 0 0 0 3px var(--accent-glow);
}

textarea::placeholder {
  color: var(--text-muted);
  opacity: 0.6;
}

/* Buttons */
button {
  font-family: inherit;
  font-size: 0.8rem;
  font-weight: 500;
  padding: 6px 12px;
  border-radius: 6px;
  cursor: pointer;
  transition: all 0.2s;
}

.btn-small {
  padding: 4px 10px;
  font-size: 0.75rem;
}

.btn-primary {
  background: var(--accent);
  color: var(--bg);
  border: none;
  box-shadow: 0 2px 10px var(--accent-glow);
}

.btn-primary:hover {
  transform: translateY(-1px);
  filter: brightness(1.1);
}

.btn-secondary {
  background: transparent;
  color: var(--text-muted);
  border: 1px solid var(--border);
}

.btn-secondary:hover {
  border-color: var(--accent);
  color: var(--text);
}

/* Tool options */
.tool-options {
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: 12px;
  padding: 20px;
  margin-bottom: 24px;
  animation: fadeIn 0.6s ease-out 0.15s both;
}

.tool-options-title {
  font-size: 0.9rem;
  font-weight: 600;
  margin-bottom: 16px;
  display: flex;
  align-items: center;
  gap: 8px;
}

.tool-options-title::before {
  content: 'âš™';
}

.option-row {
  display: flex;
  align-items: center;
  gap: 12px;
  margin-bottom: 12px;
  flex-wrap: wrap;
}

.option-row:last-child {
  margin-bottom: 0;
}

.option-section {
  background: var(--surface-raised);
  border-radius: 8px;
  padding: 12px;
  margin-bottom: 12px;
}

.option-section:last-child {
  margin-bottom: 0;
}

.option-section-title {
  font-size: 0.85rem;
  font-weight: 600;
  color: var(--text);
  margin-bottom: 10px;
}

/* Combination Generator Styles */
.combination-inputs {
  display: flex;
  gap: 8px;
  overflow-x: auto;
  padding: 12px 0;
  align-items: flex-start;
}

.combo-item {
  display: flex;
  flex-direction: column;
  align-items: center;
  flex-shrink: 0;
}

.combo-label {
  font-size: 0.75rem;
  color: var(--text-muted);
  margin-bottom: 6px;
  font-weight: 500;
}

.combo-field {
  width: 80px;
  padding: 8px;
  background: var(--bg);
  border: 1px solid var(--border);
  border-radius: 6px;
  font-size: 0.85rem;
  color: var(--text);
  text-align: center;
}

.combo-field:focus {
  outline: none;
  border-color: var(--accent);
}

.combo-textarea {
  width: 150px;
  height: 150px;
  padding: 8px;
  background: var(--bg);
  border: 1px solid var(--border);
  border-radius: 6px;
  font-family: monospace;
  font-size: 0.8rem;
  color: var(--text);
  resize: vertical;
}

.combo-textarea:focus {
  outline: none;
  border-color: var(--accent);
  box-shadow: 0 0 0 2px var(--accent-glow);
}

.combo-count {
  font-size: 0.7rem;
  color: var(--text-muted);
  margin-top: 4px;
}

.combo-delim {
  align-self: center;
  margin-top: 20px;
}

.combo-delim .combo-field {
  width: 60px;
}

.combo-prefix, .combo-suffix {
  align-self: center;
  margin-top: 20px;
}

.combo-add {
  align-self: center;
  margin-top: 20px;
}

.combo-actions {
  display: flex;
  align-items: center;
  gap: 16px;
  margin-top: 12px;
  padding-top: 12px;
  border-top: 1px solid var(--border);
}

/* Count Table Styles */
.count-table {
  overflow-x: auto;
}

.count-table table {
  width: 100%;
  border-collapse: collapse;
  font-size: 0.85rem;
}

.count-table th, .count-table td {
  padding: 10px 16px;
  text-align: center;
  border: 1px solid var(--border);
}

.count-table th {
  background: var(--bg);
  font-weight: 600;
  color: var(--text);
}

.count-table td:first-child {
  background: var(--bg);
  font-weight: 500;
  text-align: left;
}

.count-table td:not(:first-child) {
  font-size: 1.1rem;
  font-weight: 600;
  color: var(--accent);
}

/* Word Frequency Table */
.word-freq-table {
  width: 100%;
  border-collapse: collapse;
  font-size: 0.8rem;
}

.word-freq-table th, .word-freq-table td {
  padding: 6px 10px;
  text-align: left;
  border-bottom: 1px solid var(--border);
}

.word-freq-table th {
  background: var(--bg);
  font-weight: 600;
  position: sticky;
  top: 0;
}

.word-freq-table td:nth-child(2),
.word-freq-table td:nth-child(3) {
  text-align: right;
}

.option-row label {
  font-size: 0.85rem;
  color: var(--text);
  min-width: 120px;
}

.option-row input[type="text"],
.option-row select {
  flex: 1;
  min-width: 150px;
  max-width: 300px;
  padding: 8px 12px;
  background: var(--bg);
  border: 1px solid var(--border);
  border-radius: 6px;
  font-size: 0.85rem;
  color: var(--text);
}

.option-row input[type="text"]:focus,
.option-row select:focus {
  outline: none;
  border-color: var(--accent);
}

.option-row input[type="checkbox"] {
  width: 18px;
  height: 18px;
  cursor: pointer;
}

.option-row input[type="number"] {
  width: 80px;
  padding: 8px 12px;
  background: var(--bg);
  border: 1px solid var(--border);
  border-radius: 6px;
  font-size: 0.85rem;
  color: var(--text);
}

/* Execute button */
.execute-section {
  display: flex;
  justify-content: center;
  gap: 12px;
  margin-bottom: 24px;
}

.btn-execute {
  padding: 12px 32px;
  font-size: 1rem;
  font-weight: 600;
}

/* Stats bar */
.stats-bar {
  display: flex;
  gap: 16px;
  padding: 12px 16px;
  background: var(--surface-raised);
  border-top: 1px solid var(--border);
  font-size: 0.8rem;
  flex-wrap: wrap;
}

.stat-item {
  display: flex;
  align-items: center;
  gap: 6px;
}

.stat-label {
  color: var(--text-muted);
}

.stat-value {
  font-weight: 600;
  color: var(--text);
  font-variant-numeric: tabular-nums;
}

/* Footer */
footer {
  margin-top: 32px;
  text-align: center;
  color: var(--text-muted);
  font-size: 0.75rem;
  padding-top: 16px;
  border-top: 1px solid var(--border);
}

/* Hidden tool panels */
.tool-panel {
  display: none;
}

.tool-panel.active {
  display: block;
}
</style>
</head>
<body>
<div class="container">
  <header>
    <h1>
      <span class="tool-name">TextTools</span>
      <span class="katakana">ã€Šï¾ƒï½·ï½½ï¾„ï¾‚ï½°ï¾™ï½½ï¾ã€‹</span>
    </h1>
    <p class="tagline">ãƒ†ã‚­ã‚¹ãƒˆå‡¦ç†ã«ä¾¿åˆ©ãªãƒ„ãƒ¼ãƒ«é›†</p>
  </header>

  <div class="theme-selector">
    <button class="theme-btn dark" onclick="setTheme('dark')" title="ãƒ€ãƒ¼ã‚¯"></button>
    <button class="theme-btn light active" onclick="setTheme('light')" title="ãƒ©ã‚¤ãƒˆ"></button>
    <button class="theme-btn sepia" onclick="setTheme('sepia')" title="ã‚»ãƒ”ã‚¢"></button>
  </div>

  <div class="tool-tabs">
    <button class="tool-tab active" data-tool="prefix-suffix">è¡Œé ­/è¡Œæœ«è¿½åŠ </button>
    <button class="tool-tab" data-tool="line-breaks">æ”¹è¡Œè¿½åŠ /å‰Šé™¤</button>
    <button class="tool-tab" data-tool="count">æ–‡å­—ã‚«ã‚¦ãƒ³ãƒˆ</button>
    <button class="tool-tab" data-tool="column-extract">åˆ—æŠ½å‡º</button>
    <button class="tool-tab" data-tool="find-replace">æ¤œç´¢ã¨ç½®æ›</button>
    <button class="tool-tab" data-tool="combination">çµ„ã¿åˆã‚ã›ç”Ÿæˆ</button>
    <button class="tool-tab" data-tool="remove-spaces">ç©ºç™½å‰Šé™¤</button>
    <button class="tool-tab" data-tool="add-spaces">ç©ºç™½è¿½åŠ </button>
    <button class="tool-tab" data-tool="convert">æ–‡å­—å¤‰æ›</button>
    <button class="tool-tab" data-tool="line-ops">è¡Œæ“ä½œ</button>
  </div>

  <!-- Prefix/Suffix Tool -->
  <div class="tool-panel active" id="panel-prefix-suffix">
    <div class="tool-options">
      <div class="tool-options-title">è¡Œé ­/è¡Œæœ«è¿½åŠ ã‚ªãƒ—ã‚·ãƒ§ãƒ³</div>
      <div class="option-row">
        <label>è¡Œé ­ã«è¿½åŠ :</label>
        <input type="text" id="prefix-text" placeholder="ä¾‹: - ">
      </div>
      <div class="option-row">
        <label>è¡Œæœ«ã«è¿½åŠ :</label>
        <input type="text" id="suffix-text" placeholder="ä¾‹: ,">
      </div>
      <div class="option-row">
        <label>
          <input type="checkbox" id="prefix-skip-empty"> ç©ºè¡Œã‚’ã‚¹ã‚­ãƒƒãƒ—
        </label>
      </div>
    </div>
  </div>

  <!-- Line Breaks Tool -->
  <div class="tool-panel" id="panel-line-breaks">
    <div class="tool-options">
      <div class="tool-options-title">æ”¹è¡Œè¿½åŠ /å‰Šé™¤ã‚ªãƒ—ã‚·ãƒ§ãƒ³</div>
      
      <div class="option-section">
        <div class="option-section-title">â–  ã™ã¹ã¦ã®æ”¹è¡Œã‚’å‰Šé™¤</div>
        <div class="option-row">
          <label>ç½®æ›æ–‡å­—åˆ—:</label>
          <input type="text" id="lb-remove-replace" placeholder="ç©ºæ¬„ã§å˜ç´”å‰Šé™¤" style="max-width:200px;">
          <button class="btn-primary btn-small" onclick="executeLineBreakRemoveAll()">å®Ÿè¡Œ</button>
        </div>
      </div>

      <div class="option-section">
        <div class="option-section-title">â–  æŒ‡å®šæ–‡å­—åˆ—ã®å‰å¾Œã«æ”¹è¡Œã‚’è¿½åŠ </div>
        <div class="option-row">
          <label>å¯¾è±¡æ–‡å­—åˆ—:</label>
          <input type="text" id="lb-target-text" placeholder="ã“ã®æ–‡å­—åˆ—ã®å‰å¾Œã«æ”¹è¡Œ" style="max-width:200px;">
        </div>
        <div class="option-row">
          <label>
            <input type="radio" name="lb-position" value="after" checked> å¾Œã«è¿½åŠ 
          </label>
          <label>
            <input type="radio" name="lb-position" value="before"> å‰ã«è¿½åŠ 
          </label>
        </div>
        <div class="option-row">
          <label>
            <input type="checkbox" id="lb-case-sensitive"> å¤§æ–‡å­—å°æ–‡å­—ã‚’åŒºåˆ¥
          </label>
          <label>
            <input type="checkbox" id="lb-remove-existing"> æ—¢å­˜ã®æ”¹è¡Œã‚’å‰Šé™¤
          </label>
          <button class="btn-primary btn-small" onclick="executeLineBreakAtText()">å®Ÿè¡Œ</button>
        </div>
      </div>

      <div class="option-section">
        <div class="option-section-title">â–  Næ–‡å­—ã”ã¨ã«æ”¹è¡Œ</div>
        <div class="option-row">
          <label>æ–‡å­—æ•°:</label>
          <input type="number" id="lb-every-n" value="80" min="1" style="width:80px;">
        </div>
        <div class="option-row">
          <label>
            <input type="checkbox" id="lb-wordwrap"> å˜èªã®é€”ä¸­ã§åˆ‡ã‚‰ãªã„
          </label>
          <label>
            <input type="checkbox" id="lb-escape-existing"> æ—¢å­˜ã®æ”¹è¡Œã‚’ã‚¨ã‚¹ã‚±ãƒ¼ãƒ—ï¼ˆ\nã«å¤‰æ›ï¼‰
          </label>
        </div>
        <div class="option-row">
          <button class="btn-primary btn-small" onclick="executeLineBreakEveryN()">å®Ÿè¡Œ</button>
        </div>
      </div>

      <div class="option-section">
        <div class="option-section-title">â–  ãã®ä»–ã®æ”¹è¡Œæ“ä½œ</div>
        <div class="option-row">
          <button class="btn-primary btn-small" onclick="executeLineBreakAddAfterEach()">å„è¡Œã®å¾Œã«ç©ºè¡Œè¿½åŠ </button>
          <button class="btn-primary btn-small" onclick="executeLineBreakAddBeforeEach()">å„è¡Œã®å‰ã«ç©ºè¡Œè¿½åŠ </button>
          <button class="btn-primary btn-small" onclick="executeLineBreakMergeMultiple()">é€£ç¶šç©ºè¡Œã‚’1ã¤ã«</button>
        </div>
      </div>

    </div>
  </div>

  <!-- Count Tool -->
  <div class="tool-panel" id="panel-count">
    <div class="tool-options">
      <div class="tool-options-title">æ–‡å­—ã‚«ã‚¦ãƒ³ãƒˆã‚ªãƒ—ã‚·ãƒ§ãƒ³</div>
      
      <div class="option-section">
        <div class="count-table">
          <table>
            <thead>
              <tr>
                <th></th>
                <th>æ–‡å­—æ•°</th>
                <th>å˜èªæ•°</th>
                <th>æ–‡æ•°</th>
                <th>è¡Œæ•°</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>åˆè¨ˆ:</td>
                <td id="count-chars">0</td>
                <td id="count-words">0</td>
                <td id="count-sentences">0</td>
                <td id="count-lines">0</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <div class="option-section">
        <div class="option-section-title">â–  ã‚«ã‚¦ãƒ³ãƒˆã‚ªãƒ—ã‚·ãƒ§ãƒ³</div>
        <div class="option-row">
          <label>
            <input type="checkbox" id="count-no-spaces"> ã‚¹ãƒšãƒ¼ã‚¹ã‚’é™¤å¤–
          </label>
          <label>
            <input type="checkbox" id="count-no-html"> HTMLã‚¿ã‚°ã‚’é™¤å¤–
          </label>
          <label>
            <input type="checkbox" id="count-linebreak-space"> æ”¹è¡Œã‚’ã‚¹ãƒšãƒ¼ã‚¹ã¨ã—ã¦ã‚«ã‚¦ãƒ³ãƒˆ
          </label>
        </div>
      </div>

      <div class="option-section">
        <div class="option-section-title">â–  ã‚«ã‚¹ã‚¿ãƒ ã‚«ã‚¦ãƒ³ãƒˆï¼ˆç‰¹å®šæ–‡å­—åˆ—ã®å‡ºç¾å›æ•°ï¼‰</div>
        <div class="option-row">
          <input type="text" id="count-custom-query" placeholder="æ¤œç´¢ã™ã‚‹æ–‡å­—åˆ—" style="max-width:200px;">
          <label>
            <input type="checkbox" id="count-custom-case"> å¤§æ–‡å­—å°æ–‡å­—ã‚’åŒºåˆ¥
          </label>
          <span id="count-custom-result" style="font-weight:600; color:var(--accent); margin-left:10px;"></span>
        </div>
      </div>

      <div class="option-section">
        <div class="option-section-title">â–  å˜èªé »åº¦åˆ†æ</div>
        <div class="option-row">
          <button class="btn-secondary btn-small" onclick="showWordFrequency()">å˜èªé »åº¦ã‚’åˆ†æ</button>
        </div>
        <div id="word-frequency-result" style="max-height:200px; overflow-y:auto; margin-top:10px; display:none;">
        </div>
      </div>
    </div>
  </div>

  <!-- Column Extract Tool -->
  <div class="tool-panel" id="panel-column-extract">
    <div class="tool-options">
      <div class="tool-options-title">åˆ—æŠ½å‡ºã‚ªãƒ—ã‚·ãƒ§ãƒ³</div>
      
      <div class="option-section">
        <div class="option-row">
          <label>åˆ—ã®åŒºåˆ‡ã‚Šæ–‡å­—:</label>
          <select id="column-delimiter">
            <option value="comma">ã‚«ãƒ³ãƒ (,)</option>
            <option value="tab">ã‚¿ãƒ–</option>
            <option value="semicolon">ã‚»ãƒŸã‚³ãƒ­ãƒ³ (;)</option>
            <option value="space">ã‚¹ãƒšãƒ¼ã‚¹</option>
            <option value="pipe">ãƒ‘ã‚¤ãƒ— (|)</option>
            <option value="custom">ã‚«ã‚¹ã‚¿ãƒ </option>
          </select>
          <input type="text" id="column-custom-delimiter" placeholder="åŒºåˆ‡ã‚Šæ–‡å­—" style="display:none; max-width:100px;">
        </div>
        <div class="option-row">
          <label>æŠ½å‡ºã™ã‚‹åˆ—ç•ªå·:</label>
          <input type="text" id="column-numbers" value="1" placeholder="ä¾‹: 1 ã¾ãŸã¯ 1,3,5" style="max-width:150px;">
          <span style="font-size:0.75rem; color:var(--text-muted);">ï¼ˆã‚«ãƒ³ãƒåŒºåˆ‡ã‚Šã§è¤‡æ•°æŒ‡å®šå¯ï¼‰</span>
        </div>
        <div class="option-row">
          <label>
            <input type="checkbox" id="column-remove-empty" checked> ç©ºè¡Œã‚’å‰Šé™¤
          </label>
          <label>
            <input type="checkbox" id="column-trim"> å„å€¤ã®å‰å¾Œã®ç©ºç™½ã‚’å‰Šé™¤
          </label>
        </div>
        <div class="option-row">
          <label>å‡ºåŠ›ã®åŒºåˆ‡ã‚Šæ–‡å­—:</label>
          <input type="text" id="column-output-delimiter" value="," placeholder="ä¾‹: , ã¾ãŸã¯ ã‚¿ãƒ–" style="max-width:100px;">
          <span style="font-size:0.75rem; color:var(--text-muted);">ï¼ˆè¤‡æ•°åˆ—æŠ½å‡ºæ™‚ï¼‰</span>
        </div>
      </div>
    </div>
  </div>

  <!-- Find Replace Tool -->
  <div class="tool-panel" id="panel-find-replace">
    <div class="tool-options">
      <div class="tool-options-title">æ¤œç´¢ã¨ç½®æ›ã‚ªãƒ—ã‚·ãƒ§ãƒ³</div>
      <div class="option-row">
        <label>æ¤œç´¢æ–‡å­—åˆ—:</label>
        <input type="text" id="find-text" placeholder="æ¤œç´¢ã™ã‚‹æ–‡å­—åˆ—">
      </div>
      <div class="option-row">
        <label>ç½®æ›æ–‡å­—åˆ—:</label>
        <input type="text" id="replace-text" placeholder="ç½®æ›å¾Œã®æ–‡å­—åˆ—">
      </div>
      <div class="option-row">
        <label>
          <input type="checkbox" id="find-regex"> æ­£è¦è¡¨ç¾ã‚’ä½¿ç”¨
        </label>
        <label>
          <input type="checkbox" id="find-case"> å¤§æ–‡å­—å°æ–‡å­—ã‚’åŒºåˆ¥
        </label>
      </div>
    </div>
  </div>

  <!-- Line Combine Tool -->
  <!-- Combination Generator Tool -->
  <div class="tool-panel" id="panel-combination">
    <div class="tool-options">
      <div class="tool-options-title">çµ„ã¿åˆã‚ã›ç”Ÿæˆ</div>
      <p style="font-size:0.8rem; color:var(--text-muted); margin-bottom:12px;">
        è¤‡æ•°ã®ãƒªã‚¹ãƒˆã‹ã‚‰ã™ã¹ã¦ã®çµ„ã¿åˆã‚ã›ã‚’ç”Ÿæˆã—ã¾ã™ã€‚ã€Œãƒªã‚¹ãƒˆè¿½åŠ ã€ãƒœã‚¿ãƒ³ã§ãƒªã‚¹ãƒˆã‚’å¢—ã‚„ã›ã¾ã™ã€‚
      </p>
      
      <div class="combination-inputs" id="combinationInputs">
        <!-- Prefix -->
        <div class="combo-item combo-prefix">
          <div class="combo-label">Prefix</div>
          <input type="text" id="combo-prefix" class="combo-field" placeholder="">
        </div>
        
        <!-- List 1 -->
        <div class="combo-item combo-list" data-index="0">
          <div class="combo-label">ãƒªã‚¹ãƒˆ 1</div>
          <textarea class="combo-textarea" id="combo-list-0" placeholder="å„è¡Œã«1é …ç›®"></textarea>
          <div class="combo-count"><span id="combo-count-0">0</span> è¡Œ</div>
        </div>
        
        <!-- Delimiter 1 -->
        <div class="combo-item combo-delim" data-index="0">
          <div class="combo-label">åŒºåˆ‡ã‚Š</div>
          <input type="text" class="combo-field combo-delim-field" id="combo-delim-0" placeholder="">
        </div>
        
        <!-- List 2 -->
        <div class="combo-item combo-list" data-index="1">
          <div class="combo-label">ãƒªã‚¹ãƒˆ 2</div>
          <textarea class="combo-textarea" id="combo-list-1" placeholder="å„è¡Œã«1é …ç›®"></textarea>
          <div class="combo-count"><span id="combo-count-1">0</span> è¡Œ</div>
        </div>
        
        <!-- Delimiter 2 -->
        <div class="combo-item combo-delim" data-index="1">
          <div class="combo-label">åŒºåˆ‡ã‚Š</div>
          <input type="text" class="combo-field combo-delim-field" id="combo-delim-1" placeholder="">
        </div>
        
        <!-- List 3 -->
        <div class="combo-item combo-list" data-index="2">
          <div class="combo-label">ãƒªã‚¹ãƒˆ 3</div>
          <textarea class="combo-textarea" id="combo-list-2" placeholder="å„è¡Œã«1é …ç›®"></textarea>
          <div class="combo-count"><span id="combo-count-2">0</span> è¡Œ</div>
        </div>
        
        <!-- Suffix -->
        <div class="combo-item combo-suffix">
          <div class="combo-label">Suffix</div>
          <input type="text" id="combo-suffix" class="combo-field" placeholder="">
        </div>
        
        <!-- Add button -->
        <div class="combo-item combo-add">
          <button class="btn-secondary btn-small" onclick="addComboList()">+ ãƒªã‚¹ãƒˆè¿½åŠ </button>
        </div>
      </div>
      
      <div class="combo-actions">
        <span id="combination-count" style="font-size:0.85rem; color:var(--accent); font-weight:600;"></span>
        <button class="btn-secondary btn-small" onclick="clearComboInputs()">å…¥åŠ›ã‚¯ãƒªã‚¢</button>
      </div>
    </div>
  </div>

  <!-- Remove Duplicates Tool -->
  <!-- Remove Empty Lines Tool -->
  <!-- Remove/Add Spaces Tool -->
  <!-- Remove Spaces Tool -->
  <div class="tool-panel" id="panel-remove-spaces">
    <div class="tool-options">
      <div class="tool-options-title">ç©ºç™½å‰Šé™¤ã‚ªãƒ—ã‚·ãƒ§ãƒ³</div>
      
      <div class="option-section">
        <div class="option-row">
          <label>
            <input type="checkbox" id="spaces-trim" checked> è¡Œé ­/è¡Œæœ«ã®ç©ºç™½ã‚’å‰Šé™¤ï¼ˆãƒˆãƒªãƒ ï¼‰
          </label>
        </div>
        <div class="option-row">
          <label>
            <input type="radio" name="spaces-remove-mode" value="extra" checked> é€£ç¶šã™ã‚‹ç©ºç™½ã‚’1ã¤ã«
          </label>
          <label>
            <input type="radio" name="spaces-remove-mode" value="all"> ã™ã¹ã¦ã®ç©ºç™½ã‚’å‰Šé™¤
          </label>
          <label>
            <input type="radio" name="spaces-remove-mode" value="none"> å‰Šé™¤ã—ãªã„ï¼ˆãƒˆãƒªãƒ ã®ã¿ï¼‰
          </label>
        </div>
      </div>
    </div>
  </div>

  <!-- Add Spaces Tool -->
  <div class="tool-panel" id="panel-add-spaces">
    <div class="tool-options">
      <div class="tool-options-title">ç©ºç™½è¿½åŠ ã‚ªãƒ—ã‚·ãƒ§ãƒ³</div>
      
      <div class="option-section">
        <div class="option-row">
          <label>
            <input type="checkbox" id="spaces-add-every-n"> 
            <input type="number" id="spaces-add-n" value="10" min="1" style="width:60px;"> æ–‡å­—ã”ã¨ã«ç©ºç™½ã‚’è¿½åŠ 
          </label>
        </div>
        <div class="option-row">
          <label>
            <input type="checkbox" id="spaces-add-after-char"> æŒ‡å®šæ–‡å­—ã®å¾Œã«ç©ºç™½ã‚’è¿½åŠ :
          </label>
          <input type="text" id="spaces-after-char" value="." style="max-width:80px;">
        </div>
        <div class="option-row">
          <label>
            <input type="checkbox" id="spaces-add-after-line"> å„è¡Œã®æœ«å°¾ã«ç©ºç™½ã‚’è¿½åŠ 
          </label>
        </div>
      </div>
    </div>
  </div>

  <!-- Convert Tool (æ–‡å­—å¤‰æ›) -->
  <div class="tool-panel" id="panel-convert">
    <div class="tool-options">
      <div class="tool-options-title">æ–‡å­—å¤‰æ›</div>
      
      <div class="option-section">
        <div class="option-section-title">â–  å¤§æ–‡å­—/å°æ–‡å­—</div>
        <div class="option-row">
          <button class="btn-primary btn-small" onclick="executeConvert('lowercase')">å°æ–‡å­—ã«å¤‰æ›</button>
          <button class="btn-primary btn-small" onclick="executeConvert('uppercase')">å¤§æ–‡å­—ã«å¤‰æ›</button>
        </div>
      </div>

      <div class="option-section">
        <div class="option-section-title">â–  å…¨è§’/åŠè§’å¤‰æ›</div>
        <div class="option-row">
          <button class="btn-primary btn-small" onclick="executeConvert('toFullwidth')">å…¨è§’â†’åŠè§’</button>
          <button class="btn-primary btn-small" onclick="executeConvert('toHalfwidth')">åŠè§’â†’å…¨è§’</button>
        </div>
        <div class="option-row">
          <button class="btn-primary btn-small" onclick="executeConvert('hiraToFullKata')">åŠè§’ï¼‹ã²ã‚‰â†’å…¨è§’ãƒ»ã‚«ã‚¿ã‚«ãƒŠ</button>
          <button class="btn-primary btn-small" onclick="executeConvert('hiraToHalfKata')">åŠè§’ï¼‹å…¨ã‚«ã‚¿â†’å…¨è§’ãƒ»ã²ã‚‰ãŒãª</button>
        </div>
        <div class="option-row">
          <button class="btn-primary btn-small" onclick="executeConvert('alphaToFull')">å…¨è§’è‹±æ•°â†’åŠè§’è‹±æ•°</button>
          <button class="btn-primary btn-small" onclick="executeConvert('alphaToHalf')">åŠè§’è‹±æ•°â†’å…¨è§’è‹±æ•°</button>
        </div>
        <div class="option-row">
          <button class="btn-primary btn-small" onclick="executeConvert('kataToFull')">å…¨è§’ã‚«ã‚¿ã‚«ãƒŠâ†’åŠè§’ã‚«ã‚¿ã‚«ãƒŠ</button>
          <button class="btn-primary btn-small" onclick="executeConvert('kataToHalf')">åŠè§’ã‚«ã‚¿ã‚«ãƒŠâ†’å…¨è§’ã‚«ã‚¿ã‚«ãƒŠ</button>
        </div>
        <div class="option-row">
          <button class="btn-primary btn-small" onclick="executeConvert('hiraToKata')">ã²ã‚‰ãŒãªâ†’ã‚«ã‚¿ã‚«ãƒŠ</button>
          <button class="btn-primary btn-small" onclick="executeConvert('kataToHira')">ã‚«ã‚¿ã‚«ãƒŠâ†’ã²ã‚‰ãŒãª</button>
        </div>
      </div>

      <div class="option-section">
        <div class="option-section-title">â–  ã‚¹ãƒšãƒ¼ã‚¹/TABå¤‰æ›</div>
        <div class="option-row">
          <button class="btn-primary btn-small" onclick="executeConvert('tabToSpace')">TABâ†’ç©ºç™½</button>
          <button class="btn-primary btn-small" onclick="executeConvert('spaceToTab')">ç©ºç™½â†’TAB</button>
          <label style="margin-left:10px;">ã‚¹ãƒšãƒ¼ã‚¹æ•°: <input type="number" id="convert-tab-spaces" value="4" min="1" max="8" style="width:50px;"></label>
        </div>
      </div>
    </div>
  </div>

  <!-- Line Operations Tool (è¡Œæ“ä½œ) -->
  <div class="tool-panel" id="panel-line-ops">
    <div class="tool-options">
      <div class="tool-options-title">è¡Œæ“ä½œ</div>
      
      <div class="option-section">
        <div class="option-section-title">â–  ç©ºç™½ã‚’å‰Šé™¤</div>
        <div class="option-row">
          <button class="btn-primary btn-small" onclick="executeLineOps('trimLeft')">å·¦(å…ˆé ­)ã®ç©ºç™½ã‚’å‰Šé™¤</button>
          <button class="btn-primary btn-small" onclick="executeLineOps('trimRight')">å³(æœ«å°¾)ã®ç©ºç™½ã‚’å‰Šé™¤</button>
        </div>
      </div>

      <div class="option-section">
        <div class="option-section-title">â–  ã‚½ãƒ¼ãƒˆ</div>
        <div class="option-row">
          <label>
            <input type="checkbox" id="sort-numeric"> æ•°å€¤ã¨ã—ã¦ã‚½ãƒ¼ãƒˆ
          </label>
        </div>
        <div class="option-row">
          <button class="btn-primary btn-small" onclick="executeLineOps('sortAsc')">æ˜‡é †ã‚½ãƒ¼ãƒˆ</button>
          <button class="btn-primary btn-small" onclick="executeLineOps('sortDesc')">é™é †ã‚½ãƒ¼ãƒˆ</button>
        </div>
      </div>

      <div class="option-section">
        <div class="option-section-title">â–  é‡è¤‡è¡Œå‰Šé™¤</div>
        <div class="option-row">
          <label>
            <input type="checkbox" id="dup-case" checked> å¤§æ–‡å­—å°æ–‡å­—ã‚’åŒºåˆ¥
          </label>
          <label>
            <input type="checkbox" id="dup-trim"> å‰å¾Œã®ç©ºç™½ã‚’ç„¡è¦–
          </label>
          <label>
            <input type="checkbox" id="dup-keep-order" checked> å‡ºç¾é †åºã‚’ä¿æŒ
          </label>
        </div>
        <div class="option-row">
          <button class="btn-primary btn-small" onclick="executeLineOps('removeDuplicates')">ã™ã¹ã¦ã®é‡è¤‡è¡Œã‚’å‰Šé™¤</button>
          <button class="btn-primary btn-small" onclick="executeLineOps('uniq')">é€£ç¶šã—ãŸé‡è¤‡è¡Œã®ã¿å‰Šé™¤ (uniq)</button>
        </div>
      </div>

      <div class="option-section">
        <div class="option-section-title">â–  è¡Œçµåˆ</div>
        <div class="option-row">
          <label>çµåˆæ–‡å­—:</label>
          <input type="text" id="combine-delimiter" placeholder="ä¾‹: , (ç©ºæ¬„ã§ç›´æ¥çµåˆ)" style="max-width:120px;">
          <label>
            <input type="checkbox" id="combine-skip-empty" checked> ç©ºè¡Œã‚’ã‚¹ã‚­ãƒƒãƒ—
          </label>
        </div>
        <div class="option-row">
          <button class="btn-primary btn-small" onclick="executeLineOps('combine')">è¡Œã‚’çµåˆ</button>
        </div>
      </div>

      <div class="option-section">
        <div class="option-section-title">â–  ç©ºè¡Œå‰Šé™¤</div>
        <div class="option-row">
          <label>
            <input type="checkbox" id="empty-whitespace" checked> ç©ºç™½ã®ã¿ã®è¡Œã‚‚å‰Šé™¤
          </label>
        </div>
        <div class="option-row">
          <button class="btn-primary btn-small" onclick="executeLineOps('removeEmpty')">ç©ºè¡Œã‚’å‰Šé™¤</button>
        </div>
      </div>
    </div>
  </div>

  <div class="execute-section">
    <button class="btn-primary btn-execute" id="executeButton" onclick="execute()">å®Ÿè¡Œ</button>
    <button class="btn-secondary" onclick="clearAll()">ã‚¯ãƒªã‚¢</button>
    <button class="btn-secondary" id="swapButton" onclick="swapTexts()">â‡„ å…¥å‡ºåŠ›å…¥æ›¿</button>
  </div>

  <div class="main-content">
    <div class="panel input-panel" id="inputPanel">
      <div class="panel-header">
        <span class="panel-title">å…¥åŠ›ãƒ†ã‚­ã‚¹ãƒˆ</span>
        <div class="panel-actions">
          <button class="btn-secondary btn-small" onclick="sortInput('asc')">â–² æ˜‡é †</button>
          <button class="btn-secondary btn-small" onclick="sortInput('desc')">â–¼ é™é †</button>
        </div>
      </div>
      <div class="panel-body">
        <textarea id="inputText" placeholder="ã“ã“ã«ãƒ†ã‚­ã‚¹ãƒˆã‚’å…¥åŠ›..."></textarea>
      </div>
      <div class="stats-bar" id="inputStats">
        <div class="stat-item">
          <span class="stat-label">æ–‡å­—æ•°:</span>
          <span class="stat-value" id="input-chars">0</span>
        </div>
        <div class="stat-item">
          <span class="stat-label">ç©ºç™½è¾¼ã¿æ–‡å­—æ•°:</span>
          <span class="stat-value" id="input-chars-with-spaces">0</span>
        </div>
        <div class="stat-item">
          <span class="stat-label">æ”¹è¡Œæ•°:</span>
          <span class="stat-value" id="input-newlines">0</span>
        </div>
        <div class="stat-item">
          <span class="stat-label">æ”¹è¡Œè¾¼ã¿æ–‡å­—æ•°:</span>
          <span class="stat-value" id="input-chars-with-newlines">0</span>
        </div>
        <div class="stat-item">
          <span class="stat-label">è¡Œæ•°:</span>
          <span class="stat-value" id="input-lines">0</span>
        </div>
        <div class="stat-item">
          <span class="stat-label">å˜èªæ•°:</span>
          <span class="stat-value" id="input-words">0</span>
        </div>
      </div>
    </div>

    <div class="panel output-panel">
      <div class="panel-header">
        <span class="panel-title">å‡ºåŠ›çµæœ</span>
        <div class="panel-actions">
          <button class="btn-secondary btn-small" onclick="copyToClipboard()">ğŸ“‹ ã‚³ãƒ”ãƒ¼</button>
          <button class="btn-secondary btn-small" onclick="downloadOutput()">ğŸ“¥ ä¿å­˜</button>
        </div>
      </div>
      <div class="panel-body">
        <textarea id="outputText" placeholder="å‡¦ç†çµæœãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™..." readonly></textarea>
      </div>
      <div class="stats-bar" id="outputStats">
        <div class="stat-item">
          <span class="stat-label">æ–‡å­—æ•°:</span>
          <span class="stat-value" id="output-chars">0</span>
        </div>
        <div class="stat-item">
          <span class="stat-label">ç©ºç™½è¾¼ã¿æ–‡å­—æ•°:</span>
          <span class="stat-value" id="output-chars-with-spaces">0</span>
        </div>
        <div class="stat-item">
          <span class="stat-label">æ”¹è¡Œæ•°:</span>
          <span class="stat-value" id="output-newlines">0</span>
        </div>
        <div class="stat-item">
          <span class="stat-label">æ”¹è¡Œè¾¼ã¿æ–‡å­—æ•°:</span>
          <span class="stat-value" id="output-chars-with-newlines">0</span>
        </div>
        <div class="stat-item">
          <span class="stat-label">è¡Œæ•°:</span>
          <span class="stat-value" id="output-lines">0</span>
        </div>
        <div class="stat-item">
          <span class="stat-label">å˜èªæ•°:</span>
          <span class="stat-value" id="output-words">0</span>
        </div>
      </div>
    </div>
  </div>

  <footer>
    <p>ã“ã®ãƒ„ãƒ¼ãƒ«ã¯é€šä¿¡ç„¡ã—ã§ãƒ–ãƒ©ã‚¦ã‚¶å†…ã§å‹•ä½œã—ã¾ã™ã€‚</p>
  </footer>
</div>

<script>
// Current tool
let currentTool = 'prefix-suffix';

// Theme
function setTheme(theme) {
  if (theme === 'light') {
    document.documentElement.removeAttribute('data-theme');
  } else {
    document.documentElement.setAttribute('data-theme', theme);
  }
  document.querySelectorAll('.theme-btn').forEach(btn => btn.classList.remove('active'));
  document.querySelector(`.theme-btn.${theme}`).classList.add('active');
}

// Tab switching
document.querySelectorAll('.tool-tab').forEach(tab => {
  tab.addEventListener('click', () => {
    document.querySelectorAll('.tool-tab').forEach(t => t.classList.remove('active'));
    document.querySelectorAll('.tool-panel').forEach(p => p.classList.remove('active'));
    tab.classList.add('active');
    currentTool = tab.dataset.tool;
    document.getElementById(`panel-${currentTool}`).classList.add('active');
    
    // å…¥åŠ›ãƒ‘ãƒãƒ«ã€å…¥å‡ºåŠ›å…¥æ›¿ãƒœã‚¿ãƒ³ã€å®Ÿè¡Œãƒœã‚¿ãƒ³ã®è¡¨ç¤ºåˆ¶å¾¡
    const inputPanel = document.getElementById('inputPanel');
    const mainContent = document.querySelector('.main-content');
    const swapButton = document.getElementById('swapButton');
    const executeButton = document.getElementById('executeButton');
    
    // çµ„ã¿åˆã‚ã›ç”Ÿæˆ: å…¥åŠ›ãƒ‘ãƒãƒ«éè¡¨ç¤ºã€å‡ºåŠ›å…¨å¹…ã€å…¥å‡ºåŠ›å…¥æ›¿éè¡¨ç¤º
    if (currentTool === 'combination') {
      inputPanel.style.display = 'none';
      mainContent.classList.add('full-width');
      swapButton.style.display = 'none';
      executeButton.style.display = 'inline-block';
    } 
    // æ”¹è¡Œè¿½åŠ /å‰Šé™¤ã€æ–‡å­—å¤‰æ›ã€è¡Œæ“ä½œ: å„ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã«ãƒœã‚¿ãƒ³ãŒã‚ã‚‹ã®ã§å®Ÿè¡Œãƒœã‚¿ãƒ³éè¡¨ç¤º
    else if (currentTool === 'line-breaks' || currentTool === 'convert' || currentTool === 'line-ops') {
      inputPanel.style.display = 'block';
      mainContent.classList.remove('full-width');
      swapButton.style.display = 'inline-block';
      executeButton.style.display = 'none';
    }
    // ãã®ä»–: é€šå¸¸è¡¨ç¤º
    else {
      inputPanel.style.display = 'block';
      mainContent.classList.remove('full-width');
      swapButton.style.display = 'inline-block';
      executeButton.style.display = 'inline-block';
    }
  });
});

// Column delimiter change
document.getElementById('column-delimiter').addEventListener('change', function() {
  document.getElementById('column-custom-delimiter').style.display = 
    this.value === 'custom' ? 'inline-block' : 'none';
});

// Update stats
function updateStats(textareaId, prefix) {
  const text = document.getElementById(textareaId).value;
  
  // æ–‡å­—æ•°ï¼ˆç©ºç™½ãƒ»æ”¹è¡Œé™¤ãï¼‰
  const charsNoSpaces = text.replace(/[\sã€€]/g, '').length;
  // ç©ºç™½è¾¼ã¿æ–‡å­—æ•°ï¼ˆæ”¹è¡Œé™¤ãï¼‰
  const charsWithSpaces = text.replace(/\n/g, '').length;
  // æ”¹è¡Œæ•°
  const newlines = (text.match(/\n/g) || []).length;
  // æ”¹è¡Œè¾¼ã¿æ–‡å­—æ•°
  const charsWithNewlines = text.length;
  // è¡Œæ•°
  const lines = text ? text.split('\n').length : 0;
  // å˜èªæ•°
  const words = text.trim() ? text.trim().split(/\s+/).length : 0;
  
  document.getElementById(`${prefix}-chars`).textContent = charsNoSpaces.toLocaleString();
  document.getElementById(`${prefix}-chars-with-spaces`).textContent = charsWithSpaces.toLocaleString();
  document.getElementById(`${prefix}-newlines`).textContent = newlines.toLocaleString();
  document.getElementById(`${prefix}-chars-with-newlines`).textContent = charsWithNewlines.toLocaleString();
  document.getElementById(`${prefix}-lines`).textContent = lines.toLocaleString();
  document.getElementById(`${prefix}-words`).textContent = words.toLocaleString();
}

document.getElementById('inputText').addEventListener('input', () => updateStats('inputText', 'input'));
document.getElementById('outputText').addEventListener('input', () => updateStats('outputText', 'output'));

// Execute
function execute() {
  const input = document.getElementById('inputText').value;
  let output = '';
  
  switch(currentTool) {
    case 'prefix-suffix':
      output = executePrefixSuffix(input);
      break;
    case 'line-breaks':
      output = executeLineBreaks(input);
      break;
    case 'count':
      output = executeCount(input);
      break;
    case 'column-extract':
      output = executeColumnExtract(input);
      break;
    case 'find-replace':
      output = executeFindReplace(input);
      break;
    case 'combination':
      output = executeCombination(input);
      break;
    case 'remove-spaces':
      output = executeRemoveSpaces(input);
      break;
    case 'add-spaces':
      output = executeAddSpacesMain(input);
      break;
  }
  
  document.getElementById('outputText').value = output;
  updateStats('outputText', 'output');
}

// Tool implementations
function executePrefixSuffix(input) {
  const prefix = document.getElementById('prefix-text').value;
  const suffix = document.getElementById('suffix-text').value;
  const skipEmpty = document.getElementById('prefix-skip-empty').checked;
  
  return input.split('\n').map(line => {
    if (skipEmpty && line.trim() === '') return line;
    return prefix + line + suffix;
  }).join('\n');
}

// Line breaks - Remove all
function executeLineBreakRemoveAll() {
  const input = document.getElementById('inputText').value;
  const replaceWith = document.getElementById('lb-remove-replace').value;
  const output = input.replace(/\n/g, replaceWith);
  document.getElementById('outputText').value = output;
  updateStats('outputText', 'output');
}

// Line breaks - At specific text
function executeLineBreakAtText() {
  let input = document.getElementById('inputText').value;
  const targetText = document.getElementById('lb-target-text').value;
  const position = document.querySelector('input[name="lb-position"]:checked').value;
  const caseSensitive = document.getElementById('lb-case-sensitive').checked;
  const removeExisting = document.getElementById('lb-remove-existing').checked;
  
  if (!targetText) {
    alert('å¯¾è±¡æ–‡å­—åˆ—ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„');
    return;
  }
  
  // æ—¢å­˜ã®æ”¹è¡Œã‚’å‰Šé™¤
  if (removeExisting) {
    input = input.replace(/\n/g, '');
  }
  
  // æ”¹è¡Œã‚’è¿½åŠ 
  const flags = caseSensitive ? 'g' : 'gi';
  const escaped = targetText.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
  const regex = new RegExp(escaped, flags);
  
  let output;
  if (position === 'after') {
    output = input.replace(regex, match => match + '\n');
  } else {
    output = input.replace(regex, match => '\n' + match);
  }
  
  document.getElementById('outputText').value = output;
  updateStats('outputText', 'output');
}

// Line breaks - Every N characters
function executeLineBreakEveryN() {
  let input = document.getElementById('inputText').value;
  const n = parseInt(document.getElementById('lb-every-n').value) || 80;
  const wordwrap = document.getElementById('lb-wordwrap').checked;
  const escapeExisting = document.getElementById('lb-escape-existing').checked;
  
  // æ—¢å­˜ã®æ”¹è¡Œã‚’ã‚¨ã‚¹ã‚±ãƒ¼ãƒ—
  if (escapeExisting) {
    input = input.replace(/\n/g, '\\n');
  }
  
  let output = '';
  
  if (wordwrap) {
    // å˜èªã®é€”ä¸­ã§åˆ‡ã‚‰ãªã„
    const words = input.split(/(\s+)/);
    let currentLine = '';
    
    for (const word of words) {
      if (currentLine.length + word.length > n && currentLine.length > 0) {
        output += currentLine.trimEnd() + '\n';
        currentLine = word.trimStart();
      } else {
        currentLine += word;
      }
    }
    if (currentLine) {
      output += currentLine;
    }
  } else {
    // å˜ç´”ã«Næ–‡å­—ã”ã¨ã«æ”¹è¡Œ
    for (let i = 0; i < input.length; i += n) {
      output += input.substring(i, i + n);
      if (i + n < input.length) {
        output += '\n';
      }
    }
  }
  
  document.getElementById('outputText').value = output;
  updateStats('outputText', 'output');
}

// Line breaks - Add after each line
function executeLineBreakAddAfterEach() {
  const input = document.getElementById('inputText').value;
  const output = input.split('\n').join('\n\n');
  document.getElementById('outputText').value = output;
  updateStats('outputText', 'output');
}

// Line breaks - Add before each line
function executeLineBreakAddBeforeEach() {
  const input = document.getElementById('inputText').value;
  const output = input.split('\n').map((line, i) => i === 0 ? line : '\n' + line).join('\n');
  document.getElementById('outputText').value = output;
  updateStats('outputText', 'output');
}

// Line breaks - Merge multiple empty lines
function executeLineBreakMergeMultiple() {
  const input = document.getElementById('inputText').value;
  const output = input.replace(/\n{3,}/g, '\n\n');
  document.getElementById('outputText').value = output;
  updateStats('outputText', 'output');
}

function executeLineBreaks(input) {
  // This function is no longer used for line-breaks tool
  // Each operation has its own button now
  return input;
}

function executeCount(input) {
  const noSpaces = document.getElementById('count-no-spaces').checked;
  const noHtml = document.getElementById('count-no-html').checked;
  const linebreakAsSpace = document.getElementById('count-linebreak-space').checked;
  
  let text = input;
  
  // HTMLã‚¿ã‚°ã‚’é™¤å¤–
  if (noHtml) {
    text = text.replace(/<[^>]*>/g, '');
  }
  
  // æ”¹è¡Œã‚’ã‚¹ãƒšãƒ¼ã‚¹ã¨ã—ã¦ã‚«ã‚¦ãƒ³ãƒˆ
  if (linebreakAsSpace) {
    text = text.replace(/\n/g, ' ');
  }
  
  // æ–‡å­—æ•°è¨ˆç®—
  let charCount = text.replace(/\n/g, '').length;  // æ”¹è¡Œã‚’é™¤ã
  if (noSpaces) {
    charCount = text.replace(/[\sã€€]/g, '').length;  // ç©ºç™½ã‚‚é™¤ã
  }
  
  // å˜èªæ•°ï¼ˆè‹±å˜èªã¨æ—¥æœ¬èªã‚’è€ƒæ…®ï¼‰
  const wordCount = text.trim() ? text.trim().split(/\s+/).filter(w => w).length : 0;
  
  // æ–‡æ•°ï¼ˆå¥ç‚¹ãƒ»ãƒ”ãƒªã‚ªãƒ‰ãƒ»æ„Ÿå˜†ç¬¦ãƒ»ç–‘å•ç¬¦ã§åŒºåˆ‡ã‚‹ï¼‰
  const sentences = text.split(/[.!?ã€‚ï¼ï¼Ÿ]+/).filter(s => s.trim());
  const sentenceCount = sentences.length;
  
  // è¡Œæ•°
  const lineCount = input.split('\n').length;
  
  // ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’æ›´æ–°
  document.getElementById('count-chars').textContent = charCount.toLocaleString();
  document.getElementById('count-words').textContent = wordCount.toLocaleString();
  document.getElementById('count-sentences').textContent = sentenceCount.toLocaleString();
  document.getElementById('count-lines').textContent = lineCount.toLocaleString();
  
  // ã‚«ã‚¹ã‚¿ãƒ ã‚«ã‚¦ãƒ³ãƒˆ
  updateCustomCount(input);
  
  // å‡ºåŠ›ãƒ†ã‚­ã‚¹ãƒˆ
  let output = `=== æ–‡å­—ã‚«ã‚¦ãƒ³ãƒˆçµæœ ===\n`;
  output += `æ–‡å­—æ•°: ${charCount.toLocaleString()}`;
  if (noSpaces) output += `ï¼ˆç©ºç™½é™¤ãï¼‰`;
  if (noHtml) output += `ï¼ˆHTMLã‚¿ã‚°é™¤ãï¼‰`;
  output += `\n`;
  output += `å˜èªæ•°: ${wordCount.toLocaleString()}\n`;
  output += `æ–‡æ•°: ${sentenceCount.toLocaleString()}\n`;
  output += `è¡Œæ•°: ${lineCount.toLocaleString()}\n`;
  
  return output;
}

function updateCustomCount(input) {
  const query = document.getElementById('count-custom-query').value;
  const caseSensitive = document.getElementById('count-custom-case').checked;
  const resultSpan = document.getElementById('count-custom-result');
  
  if (!query) {
    resultSpan.textContent = '';
    return;
  }
  
  const flags = caseSensitive ? 'g' : 'gi';
  const escaped = query.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
  const regex = new RegExp(escaped, flags);
  const matches = input.match(regex);
  const count = matches ? matches.length : 0;
  
  resultSpan.textContent = `${count} ä»¶è¦‹ã¤ã‹ã‚Šã¾ã—ãŸ`;
}

function showWordFrequency() {
  const input = document.getElementById('inputText').value;
  const resultDiv = document.getElementById('word-frequency-result');
  
  if (!input.trim()) {
    resultDiv.style.display = 'none';
    return;
  }
  
  // å˜èªã‚’æŠ½å‡ºï¼ˆè‹±å˜èªãƒ»æ—¥æœ¬èªãƒ»æ•°å­—ã‚’å«ã‚€ï¼‰
  const words = input.toLowerCase().match(/[\p{L}\p{N}]+/gu) || [];
  const freq = {};
  words.forEach(w => freq[w] = (freq[w] || 0) + 1);
  
  const sorted = Object.entries(freq).sort((a, b) => b[1] - a[1]);
  const total = words.length;
  
  let html = `<table class="word-freq-table">
    <thead>
      <tr><th>å˜èª</th><th>å›æ•°</th><th>é »åº¦</th></tr>
    </thead>
    <tbody>`;
  
  sorted.slice(0, 50).forEach(([word, count]) => {
    const percent = ((count / total) * 100).toFixed(1);
    html += `<tr><td>${word}</td><td>${count}</td><td>${percent}%</td></tr>`;
  });
  
  html += `</tbody></table>`;
  html += `<p style="font-size:0.75rem; color:var(--text-muted); margin-top:8px;">ç·å˜èªæ•°: ${total} / ãƒ¦ãƒ‹ãƒ¼ã‚¯: ${sorted.length}</p>`;
  
  resultDiv.innerHTML = html;
  resultDiv.style.display = 'block';
}

// ã‚«ã‚¹ã‚¿ãƒ ã‚«ã‚¦ãƒ³ãƒˆã®ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ›´æ–°
document.addEventListener('DOMContentLoaded', function() {
  const customQueryInput = document.getElementById('count-custom-query');
  const customCaseCheckbox = document.getElementById('count-custom-case');
  
  if (customQueryInput) {
    customQueryInput.addEventListener('input', () => {
      const input = document.getElementById('inputText').value;
      updateCustomCount(input);
    });
  }
  
  if (customCaseCheckbox) {
    customCaseCheckbox.addEventListener('change', () => {
      const input = document.getElementById('inputText').value;
      updateCustomCount(input);
    });
  }
});

function executeColumnExtract(input) {
  let delimiter;
  const delimiterType = document.getElementById('column-delimiter').value;
  
  switch(delimiterType) {
    case 'tab': delimiter = '\t'; break;
    case 'comma': delimiter = ','; break;
    case 'semicolon': delimiter = ';'; break;
    case 'space': delimiter = /\s+/; break;
    case 'pipe': delimiter = '|'; break;
    case 'custom': delimiter = document.getElementById('column-custom-delimiter').value || ','; break;
  }
  
  // åˆ—ç•ªå·ã‚’ãƒ‘ãƒ¼ã‚¹ï¼ˆã‚«ãƒ³ãƒåŒºåˆ‡ã‚Šã§è¤‡æ•°å¯¾å¿œï¼‰
  const colNumsStr = document.getElementById('column-numbers').value;
  const colNums = colNumsStr.split(',')
    .map(s => parseInt(s.trim()) - 1)
    .filter(n => !isNaN(n) && n >= 0);
  
  if (colNums.length === 0) {
    return 'åˆ—ç•ªå·ã‚’æ­£ã—ãæŒ‡å®šã—ã¦ãã ã•ã„';
  }
  
  const removeEmpty = document.getElementById('column-remove-empty').checked;
  const trimValues = document.getElementById('column-trim').checked;
  const outputDelimiter = document.getElementById('column-output-delimiter').value;
  
  const lines = input.split('\n');
  const results = [];
  
  for (const line of lines) {
    if (removeEmpty && line.trim() === '') continue;
    
    const parts = typeof delimiter === 'string' ? line.split(delimiter) : line.split(delimiter);
    const extracted = colNums.map(colNum => {
      let val = parts[colNum] !== undefined ? parts[colNum] : '';
      if (trimValues) val = val.trim();
      return val;
    });
    
    results.push(extracted.join(outputDelimiter));
  }
  
  return results.join('\n');
}

function executeFindReplace(input) {
  const findText = document.getElementById('find-text').value;
  const replaceText = document.getElementById('replace-text').value;
  const useRegex = document.getElementById('find-regex').checked;
  const caseSensitive = document.getElementById('find-case').checked;
  
  if (!findText) return input;
  
  if (useRegex) {
    try {
      const flags = caseSensitive ? 'g' : 'gi';
      const regex = new RegExp(findText, flags);
      return input.replace(regex, replaceText);
    } catch(e) {
      return `æ­£è¦è¡¨ç¾ã‚¨ãƒ©ãƒ¼: ${e.message}`;
    }
  } else {
    if (caseSensitive) {
      return input.split(findText).join(replaceText);
    } else {
      const regex = new RegExp(findText.replace(/[.*+?^${}()|[\]\\]/g, '\\$&'), 'gi');
      return input.replace(regex, replaceText);
    }
  }
}

// Line combine (multiple lines to one line)
// Line combination generator (all combinations from multiple lists)
let comboListCount = 3; // åˆæœŸãƒªã‚¹ãƒˆæ•°

function updateComboCounts() {
  for (let i = 0; i < comboListCount; i++) {
    const textarea = document.getElementById(`combo-list-${i}`);
    const countSpan = document.getElementById(`combo-count-${i}`);
    if (textarea && countSpan) {
      const lines = textarea.value.split('\n').filter(line => line.trim() !== '');
      countSpan.textContent = lines.length;
    }
  }
  updateCombinationTotal();
}

function updateCombinationTotal() {
  const lists = [];
  for (let i = 0; i < comboListCount; i++) {
    const textarea = document.getElementById(`combo-list-${i}`);
    if (textarea) {
      const lines = textarea.value.split('\n').filter(line => line.trim() !== '');
      if (lines.length > 0) {
        lists.push(lines);
      }
    }
  }
  
  const total = lists.length > 0 ? lists.reduce((acc, list) => acc * list.length, 1) : 0;
  document.getElementById('combination-count').textContent = 
    total > 0 ? `${total.toLocaleString()} çµ„ã¿åˆã‚ã›ç”Ÿæˆäºˆå®š` : '';
}

function addComboList() {
  const container = document.getElementById('combinationInputs');
  const addBtn = container.querySelector('.combo-add');
  const suffix = container.querySelector('.combo-suffix');
  
  const newIndex = comboListCount;
  
  // æ–°ã—ã„åŒºåˆ‡ã‚Š
  const delimDiv = document.createElement('div');
  delimDiv.className = 'combo-item combo-delim';
  delimDiv.dataset.index = newIndex - 1;
  delimDiv.innerHTML = `
    <div class="combo-label">åŒºåˆ‡ã‚Š</div>
    <input type="text" class="combo-field combo-delim-field" id="combo-delim-${newIndex - 1}" placeholder="">
  `;
  
  // æ–°ã—ã„ãƒªã‚¹ãƒˆ
  const listDiv = document.createElement('div');
  listDiv.className = 'combo-item combo-list';
  listDiv.dataset.index = newIndex;
  listDiv.innerHTML = `
    <div class="combo-label">ãƒªã‚¹ãƒˆ ${newIndex + 1}</div>
    <textarea class="combo-textarea" id="combo-list-${newIndex}" placeholder="å„è¡Œã«1é …ç›®"></textarea>
    <div class="combo-count"><span id="combo-count-${newIndex}">0</span> è¡Œ</div>
  `;
  
  // Suffixã®å‰ã«æŒ¿å…¥
  container.insertBefore(delimDiv, suffix);
  container.insertBefore(listDiv, suffix);
  
  // ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼è¿½åŠ 
  document.getElementById(`combo-list-${newIndex}`).addEventListener('input', updateComboCounts);
  
  comboListCount++;
}

function clearComboInputs() {
  document.getElementById('combo-prefix').value = '';
  document.getElementById('combo-suffix').value = '';
  for (let i = 0; i < comboListCount; i++) {
    const textarea = document.getElementById(`combo-list-${i}`);
    const delim = document.getElementById(`combo-delim-${i}`);
    if (textarea) textarea.value = '';
    if (delim) delim.value = '';
  }
  updateComboCounts();
}

function executeCombination(input) {
  const prefix = document.getElementById('combo-prefix').value.replace(/\\x/g, '\n');
  const suffix = document.getElementById('combo-suffix').value.replace(/\\x/g, '\n');
  
  // ãƒªã‚¹ãƒˆã‚’åé›†
  const lists = [];
  const delimiters = [];
  
  for (let i = 0; i < comboListCount; i++) {
    const textarea = document.getElementById(`combo-list-${i}`);
    if (textarea) {
      const lines = textarea.value.split('\n').filter(line => line.trim() !== '');
      if (lines.length > 0) {
        lists.push(lines);
        // åŒºåˆ‡ã‚Šæ–‡å­—ã‚’å–å¾—ï¼ˆ\xã‚’æ”¹è¡Œã«å¤‰æ›ï¼‰
        const delimInput = document.getElementById(`combo-delim-${i}`);
        if (delimInput) {
          delimiters.push(delimInput.value.replace(/\\x/g, '\n'));
        }
      }
    }
  }
  
  if (lists.length === 0) {
    document.getElementById('combination-count').textContent = '0 çµ„ã¿åˆã‚ã›';
    return '';
  }
  
  // çµ„ã¿åˆã‚ã›æ•°ã‚’è¨ˆç®—
  const totalCombinations = lists.reduce((acc, list) => acc * list.length, 1);
  document.getElementById('combination-count').textContent = `${totalCombinations.toLocaleString()} çµ„ã¿åˆã‚ã›ç”Ÿæˆ`;
  
  // è­¦å‘Šï¼ˆå¤§é‡ã®çµ„ã¿åˆã‚ã›ï¼‰
  if (totalCombinations > 100000) {
    if (!confirm(`${totalCombinations.toLocaleString()} ä»¶ã®çµ„ã¿åˆã‚ã›ãŒç”Ÿæˆã•ã‚Œã¾ã™ã€‚ç¶šè¡Œã—ã¾ã™ã‹ï¼Ÿ`)) {
      return '';
    }
  }
  
  // å…¨çµ„ã¿åˆã‚ã›ã‚’ç”Ÿæˆ
  function generateCombinations(lists, delimiters) {
    if (lists.length === 0) return [''];
    if (lists.length === 1) return lists[0];
    
    const result = [];
    const [first, ...rest] = lists;
    const [firstDelim, ...restDelims] = delimiters;
    const restCombinations = generateCombinations(rest, restDelims);
    
    for (const item of first) {
      for (const combo of restCombinations) {
        result.push(item + (firstDelim || '') + combo);
      }
    }
    return result;
  }
  
  const combinations = generateCombinations(lists, delimiters);
  return combinations.map(combo => prefix + combo + suffix).join('\n');
}

// åˆæœŸåŒ–æ™‚ã«ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã‚’è¨­å®š
document.addEventListener('DOMContentLoaded', function() {
  for (let i = 0; i < comboListCount; i++) {
    const textarea = document.getElementById(`combo-list-${i}`);
    if (textarea) {
      textarea.addEventListener('input', updateComboCounts);
    }
  }
});

// Remove spaces
function executeRemoveSpaces(input) {
  const trim = document.getElementById('spaces-trim').checked;
  const mode = document.querySelector('input[name="spaces-remove-mode"]:checked').value;
  
  let lines = input.split('\n');
  
  lines = lines.map(line => {
    // ãƒˆãƒªãƒ 
    if (trim) {
      line = line.trim();
    }
    
    // ç©ºç™½å‰Šé™¤ãƒ¢ãƒ¼ãƒ‰
    if (mode === 'extra') {
      // é€£ç¶šã™ã‚‹ç©ºç™½ã‚’1ã¤ã«ï¼ˆåŠè§’ãƒ»å…¨è§’ã‚¹ãƒšãƒ¼ã‚¹ã€ã‚¿ãƒ–ï¼‰
      line = line.replace(/[ ã€€\t]+/g, ' ');
    } else if (mode === 'all') {
      // ã™ã¹ã¦ã®ç©ºç™½ã‚’å‰Šé™¤
      line = line.replace(/[ ã€€\t]/g, '');
    }
    
    return line;
  });
  
  return lines.join('\n');
}

// Add spaces (å®Ÿè¡Œãƒœã‚¿ãƒ³ã‹ã‚‰å‘¼ã³å‡ºã—ç”¨)
function executeAddSpacesMain(input) {
  const addEveryN = document.getElementById('spaces-add-every-n').checked;
  const addAfterChar = document.getElementById('spaces-add-after-char').checked;
  const addAfterLine = document.getElementById('spaces-add-after-line').checked;
  
  let output = input;
  
  // æŒ‡å®šæ–‡å­—ã®å¾Œã«ç©ºç™½ã‚’è¿½åŠ 
  if (addAfterChar) {
    const char = document.getElementById('spaces-after-char').value;
    if (char) {
      const escaped = char.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
      output = output.replace(new RegExp(escaped, 'g'), char + ' ');
    }
  }
  
  // Næ–‡å­—ã”ã¨ã«ç©ºç™½ã‚’è¿½åŠ 
  if (addEveryN) {
    const n = parseInt(document.getElementById('spaces-add-n').value) || 10;
    const lines = output.split('\n');
    output = lines.map(line => {
      let result = '';
      for (let i = 0; i < line.length; i += n) {
        result += line.substring(i, i + n);
        if (i + n < line.length) {
          result += ' ';
        }
      }
      return result;
    }).join('\n');
  }
  
  // å„è¡Œã®æœ«å°¾ã«ç©ºç™½ã‚’è¿½åŠ 
  if (addAfterLine) {
    output = output.split('\n').map(line => line + ' ').join('\n');
  }
  
  return output;
}

function executeRemoveSpacesOld(input) {
  // This function is no longer used
  return input;
}

// ============================================
// æ–‡å­—å¤‰æ›é–¢æ•°
// ============================================
function executeConvert(mode) {
  const input = document.getElementById('inputText').value;
  let output = input;
  
  switch(mode) {
    // å¤§æ–‡å­—/å°æ–‡å­—
    case 'lowercase':
      output = input.toLowerCase();
      break;
    case 'uppercase':
      output = input.toUpperCase();
      break;
    
    // å…¨è§’â†’åŠè§’
    case 'toFullwidth':
      output = toHalfWidth(input);
      break;
    // åŠè§’â†’å…¨è§’
    case 'toHalfwidth':
      output = toFullWidth(input);
      break;
    
    // åŠè§’ï¼‹ã²ã‚‰â†’å…¨è§’ãƒ»ã‚«ã‚¿ã‚«ãƒŠ
    case 'hiraToFullKata':
      output = toFullWidth(hiraganaToKatakana(input));
      break;
    // åŠè§’ï¼‹å…¨ã‚«ã‚¿â†’å…¨è§’ãƒ»ã²ã‚‰ãŒãª
    case 'hiraToHalfKata':
      output = toFullWidth(katakanaToHiragana(input));
      break;
    
    // å…¨è§’è‹±æ•°â†’åŠè§’è‹±æ•°
    case 'alphaToFull':
      output = fullAlphaNumToHalf(input);
      break;
    // åŠè§’è‹±æ•°â†’å…¨è§’è‹±æ•°
    case 'alphaToHalf':
      output = halfAlphaNumToFull(input);
      break;
    
    // å…¨è§’ã‚«ã‚¿ã‚«ãƒŠâ†’åŠè§’ã‚«ã‚¿ã‚«ãƒŠ
    case 'kataToFull':
      output = fullKatakanaToHalf(input);
      break;
    // åŠè§’ã‚«ã‚¿ã‚«ãƒŠâ†’å…¨è§’ã‚«ã‚¿ã‚«ãƒŠ
    case 'kataToHalf':
      output = halfKatakanaToFull(input);
      break;
    
    // ã²ã‚‰ãŒãªâ‡”ã‚«ã‚¿ã‚«ãƒŠ
    case 'hiraToKata':
      output = hiraganaToKatakana(input);
      break;
    case 'kataToHira':
      output = katakanaToHiragana(input);
      break;
    
    // TABâ‡”ç©ºç™½
    case 'tabToSpace': {
      const tabSpaces = parseInt(document.getElementById('convert-tab-spaces').value) || 4;
      output = input.replace(/\t/g, ' '.repeat(tabSpaces));
      break;
    }
    case 'spaceToTab': {
      const numSpaces = parseInt(document.getElementById('convert-tab-spaces').value) || 4;
      const spaceRegex = new RegExp(' {' + numSpaces + '}', 'g');
      output = input.replace(spaceRegex, '\t');
      break;
    }
  }
  
  document.getElementById('outputText').value = output;
  updateStats('outputText', 'output');
}

// å…¨è§’â†’åŠè§’å¤‰æ›
function toHalfWidth(str) {
  return str
    // å…¨è§’è‹±æ•°å­—â†’åŠè§’
    .replace(/[ï¼¡-ï¼ºï½-ï½šï¼-ï¼™]/g, s => String.fromCharCode(s.charCodeAt(0) - 0xFEE0))
    // å…¨è§’ã‚¹ãƒšãƒ¼ã‚¹â†’åŠè§’
    .replace(/ã€€/g, ' ')
    // å…¨è§’è¨˜å·â†’åŠè§’
    .replace(/[ï¼-ï½]/g, s => String.fromCharCode(s.charCodeAt(0) - 0xFEE0));
}

// åŠè§’â†’å…¨è§’å¤‰æ›
function toFullWidth(str) {
  return str
    // åŠè§’è‹±æ•°å­—â†’å…¨è§’
    .replace(/[A-Za-z0-9]/g, s => String.fromCharCode(s.charCodeAt(0) + 0xFEE0))
    // åŠè§’ã‚¹ãƒšãƒ¼ã‚¹â†’å…¨è§’
    .replace(/ /g, 'ã€€')
    // åŠè§’è¨˜å·â†’å…¨è§’
    .replace(/[!-~]/g, s => String.fromCharCode(s.charCodeAt(0) + 0xFEE0));
}

// ã²ã‚‰ãŒãªâ†’ã‚«ã‚¿ã‚«ãƒŠ
function hiraganaToKatakana(str) {
  return str.replace(/[\u3041-\u3096]/g, s => String.fromCharCode(s.charCodeAt(0) + 0x60));
}

// ã‚«ã‚¿ã‚«ãƒŠâ†’ã²ã‚‰ãŒãª
function katakanaToHiragana(str) {
  return str.replace(/[\u30A1-\u30F6]/g, s => String.fromCharCode(s.charCodeAt(0) - 0x60));
}

// å…¨è§’è‹±æ•°â†’åŠè§’è‹±æ•°
function fullAlphaNumToHalf(str) {
  return str.replace(/[ï¼¡-ï¼ºï½-ï½šï¼-ï¼™]/g, s => String.fromCharCode(s.charCodeAt(0) - 0xFEE0));
}

// åŠè§’è‹±æ•°â†’å…¨è§’è‹±æ•°
function halfAlphaNumToFull(str) {
  return str.replace(/[A-Za-z0-9]/g, s => String.fromCharCode(s.charCodeAt(0) + 0xFEE0));
}

// å…¨è§’ã‚«ã‚¿ã‚«ãƒŠâ†’åŠè§’ã‚«ã‚¿ã‚«ãƒŠ
function fullKatakanaToHalf(str) {
  const kanaMap = {
    'ã‚¢': 'ï½±', 'ã‚¤': 'ï½²', 'ã‚¦': 'ï½³', 'ã‚¨': 'ï½´', 'ã‚ª': 'ï½µ',
    'ã‚«': 'ï½¶', 'ã‚­': 'ï½·', 'ã‚¯': 'ï½¸', 'ã‚±': 'ï½¹', 'ã‚³': 'ï½º',
    'ã‚µ': 'ï½»', 'ã‚·': 'ï½¼', 'ã‚¹': 'ï½½', 'ã‚»': 'ï½¾', 'ã‚½': 'ï½¿',
    'ã‚¿': 'ï¾€', 'ãƒ': 'ï¾', 'ãƒ„': 'ï¾‚', 'ãƒ†': 'ï¾ƒ', 'ãƒˆ': 'ï¾„',
    'ãƒŠ': 'ï¾…', 'ãƒ‹': 'ï¾†', 'ãƒŒ': 'ï¾‡', 'ãƒ': 'ï¾ˆ', 'ãƒ': 'ï¾‰',
    'ãƒ': 'ï¾Š', 'ãƒ’': 'ï¾‹', 'ãƒ•': 'ï¾Œ', 'ãƒ˜': 'ï¾', 'ãƒ›': 'ï¾',
    'ãƒ': 'ï¾', 'ãƒŸ': 'ï¾', 'ãƒ ': 'ï¾‘', 'ãƒ¡': 'ï¾’', 'ãƒ¢': 'ï¾“',
    'ãƒ¤': 'ï¾”', 'ãƒ¦': 'ï¾•', 'ãƒ¨': 'ï¾–',
    'ãƒ©': 'ï¾—', 'ãƒª': 'ï¾˜', 'ãƒ«': 'ï¾™', 'ãƒ¬': 'ï¾š', 'ãƒ­': 'ï¾›',
    'ãƒ¯': 'ï¾œ', 'ãƒ²': 'ï½¦', 'ãƒ³': 'ï¾',
    'ã‚¡': 'ï½§', 'ã‚£': 'ï½¨', 'ã‚¥': 'ï½©', 'ã‚§': 'ï½ª', 'ã‚©': 'ï½«',
    'ãƒƒ': 'ï½¯', 'ãƒ£': 'ï½¬', 'ãƒ¥': 'ï½­', 'ãƒ§': 'ï½®',
    'ã‚¬': 'ï½¶ï¾', 'ã‚®': 'ï½·ï¾', 'ã‚°': 'ï½¸ï¾', 'ã‚²': 'ï½¹ï¾', 'ã‚´': 'ï½ºï¾',
    'ã‚¶': 'ï½»ï¾', 'ã‚¸': 'ï½¼ï¾', 'ã‚º': 'ï½½ï¾', 'ã‚¼': 'ï½¾ï¾', 'ã‚¾': 'ï½¿ï¾',
    'ãƒ€': 'ï¾€ï¾', 'ãƒ‚': 'ï¾ï¾', 'ãƒ…': 'ï¾‚ï¾', 'ãƒ‡': 'ï¾ƒï¾', 'ãƒ‰': 'ï¾„ï¾',
    'ãƒ': 'ï¾Šï¾', 'ãƒ“': 'ï¾‹ï¾', 'ãƒ–': 'ï¾Œï¾', 'ãƒ™': 'ï¾ï¾', 'ãƒœ': 'ï¾ï¾',
    'ãƒ‘': 'ï¾Šï¾Ÿ', 'ãƒ”': 'ï¾‹ï¾Ÿ', 'ãƒ—': 'ï¾Œï¾Ÿ', 'ãƒš': 'ï¾ï¾Ÿ', 'ãƒ': 'ï¾ï¾Ÿ',
    'ãƒ´': 'ï½³ï¾', 'ãƒ¼': 'ï½°', 'ã€‚': 'ï½¡', 'ã€': 'ï½¤', 'ã€Œ': 'ï½¢', 'ã€': 'ï½£'
  };
  return str.replace(/[ã‚¢-ãƒ´ãƒ¼ã€‚ã€ã€Œã€]/g, s => kanaMap[s] || s);
}

// åŠè§’ã‚«ã‚¿ã‚«ãƒŠâ†’å…¨è§’ã‚«ã‚¿ã‚«ãƒŠ
function halfKatakanaToFull(str) {
  const kanaMap = {
    'ï½±': 'ã‚¢', 'ï½²': 'ã‚¤', 'ï½³': 'ã‚¦', 'ï½´': 'ã‚¨', 'ï½µ': 'ã‚ª',
    'ï½¶': 'ã‚«', 'ï½·': 'ã‚­', 'ï½¸': 'ã‚¯', 'ï½¹': 'ã‚±', 'ï½º': 'ã‚³',
    'ï½»': 'ã‚µ', 'ï½¼': 'ã‚·', 'ï½½': 'ã‚¹', 'ï½¾': 'ã‚»', 'ï½¿': 'ã‚½',
    'ï¾€': 'ã‚¿', 'ï¾': 'ãƒ', 'ï¾‚': 'ãƒ„', 'ï¾ƒ': 'ãƒ†', 'ï¾„': 'ãƒˆ',
    'ï¾…': 'ãƒŠ', 'ï¾†': 'ãƒ‹', 'ï¾‡': 'ãƒŒ', 'ï¾ˆ': 'ãƒ', 'ï¾‰': 'ãƒ',
    'ï¾Š': 'ãƒ', 'ï¾‹': 'ãƒ’', 'ï¾Œ': 'ãƒ•', 'ï¾': 'ãƒ˜', 'ï¾': 'ãƒ›',
    'ï¾': 'ãƒ', 'ï¾': 'ãƒŸ', 'ï¾‘': 'ãƒ ', 'ï¾’': 'ãƒ¡', 'ï¾“': 'ãƒ¢',
    'ï¾”': 'ãƒ¤', 'ï¾•': 'ãƒ¦', 'ï¾–': 'ãƒ¨',
    'ï¾—': 'ãƒ©', 'ï¾˜': 'ãƒª', 'ï¾™': 'ãƒ«', 'ï¾š': 'ãƒ¬', 'ï¾›': 'ãƒ­',
    'ï¾œ': 'ãƒ¯', 'ï½¦': 'ãƒ²', 'ï¾': 'ãƒ³',
    'ï½§': 'ã‚¡', 'ï½¨': 'ã‚£', 'ï½©': 'ã‚¥', 'ï½ª': 'ã‚§', 'ï½«': 'ã‚©',
    'ï½¯': 'ãƒƒ', 'ï½¬': 'ãƒ£', 'ï½­': 'ãƒ¥', 'ï½®': 'ãƒ§',
    'ï½°': 'ãƒ¼', 'ï½¡': 'ã€‚', 'ï½¤': 'ã€', 'ï½¢': 'ã€Œ', 'ï½£': 'ã€'
  };
  // æ¿ç‚¹ãƒ»åŠæ¿ç‚¹ã®å‡¦ç†
  return str
    .replace(/ï½¶ï¾/g, 'ã‚¬').replace(/ï½·ï¾/g, 'ã‚®').replace(/ï½¸ï¾/g, 'ã‚°').replace(/ï½¹ï¾/g, 'ã‚²').replace(/ï½ºï¾/g, 'ã‚´')
    .replace(/ï½»ï¾/g, 'ã‚¶').replace(/ï½¼ï¾/g, 'ã‚¸').replace(/ï½½ï¾/g, 'ã‚º').replace(/ï½¾ï¾/g, 'ã‚¼').replace(/ï½¿ï¾/g, 'ã‚¾')
    .replace(/ï¾€ï¾/g, 'ãƒ€').replace(/ï¾ï¾/g, 'ãƒ‚').replace(/ï¾‚ï¾/g, 'ãƒ…').replace(/ï¾ƒï¾/g, 'ãƒ‡').replace(/ï¾„ï¾/g, 'ãƒ‰')
    .replace(/ï¾Šï¾/g, 'ãƒ').replace(/ï¾‹ï¾/g, 'ãƒ“').replace(/ï¾Œï¾/g, 'ãƒ–').replace(/ï¾ï¾/g, 'ãƒ™').replace(/ï¾ï¾/g, 'ãƒœ')
    .replace(/ï¾Šï¾Ÿ/g, 'ãƒ‘').replace(/ï¾‹ï¾Ÿ/g, 'ãƒ”').replace(/ï¾Œï¾Ÿ/g, 'ãƒ—').replace(/ï¾ï¾Ÿ/g, 'ãƒš').replace(/ï¾ï¾Ÿ/g, 'ãƒ')
    .replace(/ï½³ï¾/g, 'ãƒ´')
    .replace(/[ï½±-ï¾ï½§-ï½®ï½°ï½¡ï½¤ï½¢ï½£]/g, s => kanaMap[s] || s);
}

// ============================================
// è¡Œæ“ä½œé–¢æ•°
// ============================================
function executeLineOps(mode) {
  const input = document.getElementById('inputText').value;
  let lines = input.split('\n');
  let output = '';
  
  switch(mode) {
    case 'trimLeft':
      output = lines.map(line => line.replace(/^[\sã€€]+/, '')).join('\n');
      break;
    case 'trimRight':
      output = lines.map(line => line.replace(/[\sã€€]+$/, '')).join('\n');
      break;
    case 'sortAsc': {
      const numeric = document.getElementById('sort-numeric').checked;
      if (numeric) {
        output = lines.sort((a, b) => {
          const numA = parseFloat(a) || 0;
          const numB = parseFloat(b) || 0;
          return numA - numB;
        }).join('\n');
      } else {
        output = lines.sort((a, b) => a.localeCompare(b, 'ja')).join('\n');
      }
      break;
    }
    case 'sortDesc': {
      const numeric = document.getElementById('sort-numeric').checked;
      if (numeric) {
        output = lines.sort((a, b) => {
          const numA = parseFloat(a) || 0;
          const numB = parseFloat(b) || 0;
          return numB - numA;
        }).join('\n');
      } else {
        output = lines.sort((a, b) => b.localeCompare(a, 'ja')).join('\n');
      }
      break;
    }
    case 'uniq':
      // é€£ç¶šã—ãŸé‡è¤‡è¡Œã®ã¿å‰Šé™¤ï¼ˆunixã®uniqã‚³ãƒãƒ³ãƒ‰ã¨åŒæ§˜ï¼‰
      output = lines.filter((line, i) => i === 0 || line !== lines[i - 1]).join('\n');
      break;
    case 'combine': {
      // è¡Œçµåˆ
      const delimiter = document.getElementById('combine-delimiter').value;
      const skipEmpty = document.getElementById('combine-skip-empty').checked;
      let targetLines = lines;
      if (skipEmpty) {
        targetLines = lines.filter(line => line.trim() !== '');
      }
      output = targetLines.join(delimiter);
      break;
    }
    case 'removeEmpty': {
      // ç©ºè¡Œå‰Šé™¤
      const removeWhitespaceOnly = document.getElementById('empty-whitespace').checked;
      if (removeWhitespaceOnly) {
        output = lines.filter(line => line.trim() !== '').join('\n');
      } else {
        output = lines.filter(line => line !== '').join('\n');
      }
      break;
    }
    case 'removeDuplicates': {
      // ã™ã¹ã¦ã®é‡è¤‡è¡Œã‚’å‰Šé™¤
      const caseSensitive = document.getElementById('dup-case').checked;
      const trim = document.getElementById('dup-trim').checked;
      const keepOrder = document.getElementById('dup-keep-order').checked;
      const seen = new Set();
      const result = [];
      
      for (const line of lines) {
        let key = trim ? line.trim() : line;
        if (!caseSensitive) key = key.toLowerCase();
        
        if (!seen.has(key)) {
          seen.add(key);
          result.push(line);
        }
      }
      
      if (!keepOrder) {
        result.sort((a, b) => a.localeCompare(b, 'ja'));
      }
      
      output = result.join('\n');
      break;
    }
  }
  
  document.getElementById('outputText').value = output;
  updateStats('outputText', 'output');
}

// Utilities
function clearAll() {
  document.getElementById('inputText').value = '';
  document.getElementById('outputText').value = '';
  updateStats('inputText', 'input');
  updateStats('outputText', 'output');
}

function swapTexts() {
  const input = document.getElementById('inputText');
  const output = document.getElementById('outputText');
  const temp = input.value;
  input.value = output.value;
  output.value = temp;
  updateStats('inputText', 'input');
  updateStats('outputText', 'output');
}

function sortInput(order) {
  const textarea = document.getElementById('inputText');
  const lines = textarea.value.split('\n');
  lines.sort((a, b) => {
    const result = a.localeCompare(b, 'ja');
    return order === 'asc' ? result : -result;
  });
  textarea.value = lines.join('\n');
  updateStats('inputText', 'input');
}

async function copyToClipboard() {
  const text = document.getElementById('outputText').value;
  await navigator.clipboard.writeText(text);
}

function downloadOutput() {
  const text = document.getElementById('outputText').value;
  const blob = new Blob([text], { type: 'text/plain' });
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  const now = new Date();
  const timestamp = now.toISOString().slice(0, 19).replace(/[-:]/g, '').replace('T', '_');
  a.href = url;
  a.download = `TextTools_${timestamp}.txt`;
  a.click();
  URL.revokeObjectURL(url);
}

// Keyboard shortcut
document.addEventListener('keydown', (e) => {
  if ((e.ctrlKey || e.metaKey) && e.key === 'Enter') {
    e.preventDefault();
    execute();
  }
});

// Initial stats
updateStats('inputText', 'input');
updateStats('outputText', 'output');

// ============================================
// ãƒ†ã‚¹ãƒˆé–¢æ•° - ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã§ runAllTests() ã‚’å®Ÿè¡Œ
// ============================================
function runAllTests() {
  console.log('========================================');
  console.log('TextTools å…¨æ©Ÿèƒ½ãƒ†ã‚¹ãƒˆé–‹å§‹');
  console.log('========================================');
  
  let passed = 0;
  let failed = 0;
  
  function test(name, fn) {
    try {
      const result = fn();
      if (result === true) {
        console.log(`âœ… PASS: ${name}`);
        passed++;
      } else {
        console.log(`âŒ FAIL: ${name} - çµæœ: ${result}`);
        failed++;
      }
    } catch (e) {
      console.log(`âŒ ERROR: ${name} - ${e.message}`);
      failed++;
    }
  }
  
  // 1. è¡Œé ­/è¡Œæœ«è¿½åŠ 
  test('è¡Œé ­/è¡Œæœ«è¿½åŠ  - Prefixè¿½åŠ ', () => {
    document.getElementById('prefix-text').value = '> ';
    document.getElementById('suffix-text').value = '';
    document.getElementById('prefix-skip-empty').checked = false;
    const result = executePrefixSuffix('line1\nline2\nline3');
    return result === '> line1\n> line2\n> line3';
  });
  
  test('è¡Œé ­/è¡Œæœ«è¿½åŠ  - Suffixè¿½åŠ ', () => {
    document.getElementById('prefix-text').value = '';
    document.getElementById('suffix-text').value = '!';
    const result = executePrefixSuffix('a\nb\nc');
    return result === 'a!\nb!\nc!';
  });
  
  test('è¡Œé ­/è¡Œæœ«è¿½åŠ  - Prefix+SuffixåŒæ™‚', () => {
    document.getElementById('prefix-text').value = '[';
    document.getElementById('suffix-text').value = ']';
    document.getElementById('prefix-skip-empty').checked = false;
    const result = executePrefixSuffix('a\nb');
    return result === '[a]\n[b]';
  });
  
  test('è¡Œé ­/è¡Œæœ«è¿½åŠ  - ç©ºè¡Œã‚¹ã‚­ãƒƒãƒ—ON', () => {
    document.getElementById('prefix-text').value = '- ';
    document.getElementById('suffix-text').value = '';
    document.getElementById('prefix-skip-empty').checked = true;
    const result = executePrefixSuffix('a\n\nb');
    return result === '- a\n\n- b';
  });
  
  test('è¡Œé ­/è¡Œæœ«è¿½åŠ  - ç©ºè¡Œã‚¹ã‚­ãƒƒãƒ—OFF', () => {
    document.getElementById('prefix-text').value = '- ';
    document.getElementById('suffix-text').value = '';
    document.getElementById('prefix-skip-empty').checked = false;
    const result = executePrefixSuffix('a\n\nb');
    return result === '- a\n- \n- b';
  });
  
  // 2. æ”¹è¡Œè¿½åŠ /å‰Šé™¤
  test('æ”¹è¡Œå‰Šé™¤ - ã™ã¹ã¦å‰Šé™¤', () => {
    document.getElementById('inputText').value = 'a\nb\nc';
    document.getElementById('lb-remove-replace').value = '';
    executeLineBreakRemoveAll();
    return document.getElementById('outputText').value === 'abc';
  });
  
  test('æ”¹è¡Œå‰Šé™¤ - ã‚¹ãƒšãƒ¼ã‚¹ã§ç½®æ›', () => {
    document.getElementById('inputText').value = 'a\nb\nc';
    document.getElementById('lb-remove-replace').value = ' ';
    executeLineBreakRemoveAll();
    return document.getElementById('outputText').value === 'a b c';
  });
  
  test('æ”¹è¡Œå‰Šé™¤ - ã‚«ãƒ³ãƒã§ç½®æ›', () => {
    document.getElementById('inputText').value = 'a\nb\nc';
    document.getElementById('lb-remove-replace').value = ',';
    executeLineBreakRemoveAll();
    return document.getElementById('outputText').value === 'a,b,c';
  });
  
  test('æ”¹è¡Œè¿½åŠ  - æŒ‡å®šæ–‡å­—ã®å¾Œ', () => {
    document.getElementById('inputText').value = 'a.b.c';
    document.getElementById('lb-target-text').value = '.';
    document.querySelector('input[name="lb-position"][value="after"]').checked = true;
    document.getElementById('lb-case-sensitive').checked = false;
    document.getElementById('lb-remove-existing').checked = false;
    executeLineBreakAtText();
    return document.getElementById('outputText').value === 'a.\nb.\nc';
  });
  
  test('æ”¹è¡Œè¿½åŠ  - æŒ‡å®šæ–‡å­—ã®å‰', () => {
    document.getElementById('inputText').value = 'a.b.c';
    document.getElementById('lb-target-text').value = '.';
    document.querySelector('input[name="lb-position"][value="before"]').checked = true;
    document.getElementById('lb-case-sensitive').checked = false;
    document.getElementById('lb-remove-existing').checked = false;
    executeLineBreakAtText();
    return document.getElementById('outputText').value === 'a\n.b\n.c';
  });
  
  test('æ”¹è¡Œè¿½åŠ  - å¤§æ–‡å­—å°æ–‡å­—åŒºåˆ¥ON', () => {
    document.getElementById('inputText').value = 'aAbAa';
    document.getElementById('lb-target-text').value = 'A';
    document.querySelector('input[name="lb-position"][value="after"]').checked = true;
    document.getElementById('lb-case-sensitive').checked = true;
    document.getElementById('lb-remove-existing').checked = false;
    executeLineBreakAtText();
    return document.getElementById('outputText').value === 'aA\nbA\na';
  });
  
  test('æ”¹è¡Œè¿½åŠ  - Næ–‡å­—ã”ã¨', () => {
    document.getElementById('inputText').value = 'abcdefghij';
    document.getElementById('lb-every-n').value = '3';
    document.getElementById('lb-wordwrap').checked = false;
    document.getElementById('lb-escape-existing').checked = false;
    executeLineBreakEveryN();
    return document.getElementById('outputText').value === 'abc\ndef\nghi\nj';
  });
  
  test('æ”¹è¡Œè¿½åŠ  - Næ–‡å­—ã”ã¨ï¼ˆãƒ¯ãƒ¼ãƒ‰ãƒ©ãƒƒãƒ—ï¼‰', () => {
    document.getElementById('inputText').value = 'hello world test';
    document.getElementById('lb-every-n').value = '8';
    document.getElementById('lb-wordwrap').checked = true;
    document.getElementById('lb-escape-existing').checked = false;
    executeLineBreakEveryN();
    const output = document.getElementById('outputText').value;
    return output.includes('hello') && output.includes('\n');
  });
  
  test('æ”¹è¡Œè¿½åŠ  - Næ–‡å­—ã”ã¨ï¼ˆæ—¢å­˜æ”¹è¡Œã‚¨ã‚¹ã‚±ãƒ¼ãƒ—ï¼‰', () => {
    document.getElementById('inputText').value = 'ab\ncd';
    document.getElementById('lb-every-n').value = '5';
    document.getElementById('lb-wordwrap').checked = false;
    document.getElementById('lb-escape-existing').checked = true;
    executeLineBreakEveryN();
    return document.getElementById('outputText').value === 'ab\\nc\nd';
  });
  
  test('æ”¹è¡Œè¿½åŠ  - å„è¡Œã®å¾Œã«ç©ºè¡Œ', () => {
    document.getElementById('inputText').value = 'a\nb';
    executeLineBreakAddAfterEach();
    return document.getElementById('outputText').value === 'a\n\nb';
  });
  
  test('æ”¹è¡Œè¿½åŠ  - å„è¡Œã®å‰ã«ç©ºè¡Œ', () => {
    document.getElementById('inputText').value = 'a\nb';
    executeLineBreakAddBeforeEach();
    return document.getElementById('outputText').value === 'a\n\nb';
  });
  
  test('æ”¹è¡Œè¿½åŠ  - é€£ç¶šç©ºè¡Œã‚’1ã¤ã«', () => {
    document.getElementById('inputText').value = 'a\n\n\nb\n\nc';
    executeLineBreakMergeMultiple();
    return document.getElementById('outputText').value === 'a\n\nb\n\nc';
  });
  
  // 3. æ–‡å­—ã‚«ã‚¦ãƒ³ãƒˆ
  test('æ–‡å­—ã‚«ã‚¦ãƒ³ãƒˆ - åŸºæœ¬', () => {
    document.getElementById('count-no-spaces').checked = false;
    document.getElementById('count-no-html').checked = false;
    document.getElementById('count-linebreak-space').checked = false;
    const result = executeCount('Hello World');
    return result.includes('11');
  });
  
  test('æ–‡å­—ã‚«ã‚¦ãƒ³ãƒˆ - ã‚¹ãƒšãƒ¼ã‚¹é™¤å¤–', () => {
    document.getElementById('count-no-spaces').checked = true;
    document.getElementById('count-no-html').checked = false;
    const result = executeCount('Hello World');
    return result.includes('10');
  });
  
  test('æ–‡å­—ã‚«ã‚¦ãƒ³ãƒˆ - HTMLã‚¿ã‚°é™¤å¤–', () => {
    document.getElementById('count-no-spaces').checked = false;
    document.getElementById('count-no-html').checked = true;
    const result = executeCount('<p>Hello</p>');
    return result.includes('5');
  });
  
  test('æ–‡å­—ã‚«ã‚¦ãƒ³ãƒˆ - æ”¹è¡Œã‚’ã‚¹ãƒšãƒ¼ã‚¹ã¨ã—ã¦', () => {
    document.getElementById('count-no-spaces').checked = false;
    document.getElementById('count-no-html').checked = false;
    document.getElementById('count-linebreak-space').checked = true;
    const result = executeCount('a\nb');
    return result.includes('3');
  });
  
  // 4. åˆ—æŠ½å‡º
  test('åˆ—æŠ½å‡º - ã‚«ãƒ³ãƒåŒºåˆ‡ã‚Š1åˆ—ç›®', () => {
    document.getElementById('column-delimiter').value = 'comma';
    document.getElementById('column-numbers').value = '1';
    document.getElementById('column-remove-empty').checked = true;
    document.getElementById('column-trim').checked = true;
    document.getElementById('column-output-delimiter').value = ',';
    const result = executeColumnExtract('a,b,c\n1,2,3');
    return result === 'a\n1';
  });
  
  test('åˆ—æŠ½å‡º - è¤‡æ•°åˆ—', () => {
    document.getElementById('column-delimiter').value = 'comma';
    document.getElementById('column-numbers').value = '1,3';
    const result = executeColumnExtract('a,b,c\n1,2,3');
    return result === 'a,c\n1,3';
  });
  
  test('åˆ—æŠ½å‡º - ã‚¿ãƒ–åŒºåˆ‡ã‚Š', () => {
    document.getElementById('column-delimiter').value = 'tab';
    document.getElementById('column-numbers').value = '2';
    const result = executeColumnExtract('a\tb\tc\n1\t2\t3');
    return result === 'b\n2';
  });
  
  test('åˆ—æŠ½å‡º - ãƒ‘ã‚¤ãƒ—åŒºåˆ‡ã‚Š', () => {
    document.getElementById('column-delimiter').value = 'pipe';
    document.getElementById('column-numbers').value = '1';
    const result = executeColumnExtract('a|b|c\n1|2|3');
    return result === 'a\n1';
  });
  
  test('åˆ—æŠ½å‡º - ãƒˆãƒªãƒ ON', () => {
    document.getElementById('column-delimiter').value = 'comma';
    document.getElementById('column-numbers').value = '1';
    document.getElementById('column-trim').checked = true;
    const result = executeColumnExtract('  a  ,b,c');
    return result === 'a';
  });
  
  // 5. æ¤œç´¢ã¨ç½®æ›
  test('æ¤œç´¢ã¨ç½®æ› - å˜ç´”ç½®æ›', () => {
    document.getElementById('find-text').value = 'cat';
    document.getElementById('replace-text').value = 'dog';
    document.getElementById('find-regex').checked = false;
    document.getElementById('find-case').checked = false;
    const result = executeFindReplace('I have a cat');
    return result === 'I have a dog';
  });
  
  test('æ¤œç´¢ã¨ç½®æ› - å¤§æ–‡å­—å°æ–‡å­—åŒºåˆ¥ON', () => {
    document.getElementById('find-text').value = 'Cat';
    document.getElementById('replace-text').value = 'dog';
    document.getElementById('find-regex').checked = false;
    document.getElementById('find-case').checked = true;
    const result = executeFindReplace('cat Cat CAT');
    return result === 'cat dog CAT';
  });
  
  test('æ¤œç´¢ã¨ç½®æ› - å¤§æ–‡å­—å°æ–‡å­—åŒºåˆ¥OFF', () => {
    document.getElementById('find-text').value = 'cat';
    document.getElementById('replace-text').value = 'dog';
    document.getElementById('find-regex').checked = false;
    document.getElementById('find-case').checked = false;
    const result = executeFindReplace('cat Cat CAT');
    return result === 'dog dog dog';
  });
  
  test('æ¤œç´¢ã¨ç½®æ› - æ­£è¦è¡¨ç¾', () => {
    document.getElementById('find-text').value = '\\d+';
    document.getElementById('replace-text').value = 'X';
    document.getElementById('find-regex').checked = true;
    const result = executeFindReplace('abc123def456');
    return result === 'abcXdefX';
  });
  
  test('æ¤œç´¢ã¨ç½®æ› - æ­£è¦è¡¨ç¾ã‚°ãƒ«ãƒ¼ãƒ—', () => {
    document.getElementById('find-text').value = '(\\w+)@(\\w+)';
    document.getElementById('replace-text').value = '$2:$1';
    document.getElementById('find-regex').checked = true;
    const result = executeFindReplace('user@domain');
    return result === 'domain:user';
  });
  
  // 6. è¡Œçµåˆï¼ˆè¡Œæ“ä½œã«çµ±åˆï¼‰
  test('è¡Œæ“ä½œ - è¡Œçµåˆ - ã‚«ãƒ³ãƒã§çµåˆ', () => {
    document.getElementById('combine-delimiter').value = ',';
    document.getElementById('combine-skip-empty').checked = true;
    document.getElementById('inputText').value = 'a\nb\nc';
    executeLineOps('combine');
    return document.getElementById('outputText').value === 'a,b,c';
  });
  
  test('è¡Œæ“ä½œ - è¡Œçµåˆ - ç©ºæ¬„ã§ç›´æ¥çµåˆ', () => {
    document.getElementById('combine-delimiter').value = '';
    document.getElementById('combine-skip-empty').checked = true;
    document.getElementById('inputText').value = 'a\nb\nc';
    executeLineOps('combine');
    return document.getElementById('outputText').value === 'abc';
  });
  
  test('è¡Œæ“ä½œ - è¡Œçµåˆ - ç©ºè¡Œã‚¹ã‚­ãƒƒãƒ—ON', () => {
    document.getElementById('combine-delimiter').value = '-';
    document.getElementById('combine-skip-empty').checked = true;
    document.getElementById('inputText').value = 'a\n\nb';
    executeLineOps('combine');
    return document.getElementById('outputText').value === 'a-b';
  });
  
  test('è¡Œæ“ä½œ - è¡Œçµåˆ - ç©ºè¡Œã‚¹ã‚­ãƒƒãƒ—OFF', () => {
    document.getElementById('combine-delimiter').value = '-';
    document.getElementById('combine-skip-empty').checked = false;
    document.getElementById('inputText').value = 'a\n\nb';
    executeLineOps('combine');
    return document.getElementById('outputText').value === 'a--b';
  });
  
  // 7. çµ„ã¿åˆã‚ã›ç”Ÿæˆ
  test('çµ„ã¿åˆã‚ã›ç”Ÿæˆ - 2ãƒªã‚¹ãƒˆ', () => {
    document.getElementById('combo-list-0').value = 'A\nB';
    document.getElementById('combo-list-1').value = '1\n2';
    document.getElementById('combo-list-2').value = '';
    document.getElementById('combo-delim-0').value = '';
    document.getElementById('combo-delim-1').value = '';
    document.getElementById('combo-prefix').value = '';
    document.getElementById('combo-suffix').value = '';
    const result = executeCombination('');
    return result === 'A1\nA2\nB1\nB2';
  });
  
  test('çµ„ã¿åˆã‚ã›ç”Ÿæˆ - 3ãƒªã‚¹ãƒˆ', () => {
    document.getElementById('combo-list-0').value = 'A';
    document.getElementById('combo-list-1').value = '1';
    document.getElementById('combo-list-2').value = 'X\nY';
    document.getElementById('combo-delim-0').value = '';
    document.getElementById('combo-delim-1').value = '';
    document.getElementById('combo-prefix').value = '';
    document.getElementById('combo-suffix').value = '';
    const result = executeCombination('');
    return result === 'A1X\nA1Y';
  });
  
  test('çµ„ã¿åˆã‚ã›ç”Ÿæˆ - åŒºåˆ‡ã‚Šä»˜ã', () => {
    document.getElementById('combo-list-0').value = 'X\nY';
    document.getElementById('combo-list-1').value = '1';
    document.getElementById('combo-list-2').value = '';
    document.getElementById('combo-delim-0').value = '-';
    document.getElementById('combo-prefix').value = '[';
    document.getElementById('combo-suffix').value = ']';
    const result = executeCombination('');
    return result === '[X-1]\n[Y-1]';
  });
  
  // 8. é‡è¤‡è¡Œå‰Šé™¤ï¼ˆè¡Œæ“ä½œã«çµ±åˆï¼‰
  test('è¡Œæ“ä½œ - é‡è¤‡è¡Œå‰Šé™¤ - åŸºæœ¬', () => {
    document.getElementById('dup-case').checked = false;
    document.getElementById('dup-trim').checked = false;
    document.getElementById('dup-keep-order').checked = true;
    document.getElementById('inputText').value = 'a\nb\na\nc\nb';
    executeLineOps('removeDuplicates');
    return document.getElementById('outputText').value === 'a\nb\nc';
  });
  
  test('è¡Œæ“ä½œ - é‡è¤‡è¡Œå‰Šé™¤ - å¤§æ–‡å­—å°æ–‡å­—åŒºåˆ¥ON', () => {
    document.getElementById('dup-case').checked = true;
    document.getElementById('dup-trim').checked = false;
    document.getElementById('dup-keep-order').checked = true;
    document.getElementById('inputText').value = 'A\na\nA';
    executeLineOps('removeDuplicates');
    return document.getElementById('outputText').value === 'A\na';
  });
  
  test('è¡Œæ“ä½œ - é‡è¤‡è¡Œå‰Šé™¤ - å¤§æ–‡å­—å°æ–‡å­—åŒºåˆ¥OFF', () => {
    document.getElementById('dup-case').checked = false;
    document.getElementById('dup-trim').checked = false;
    document.getElementById('dup-keep-order').checked = true;
    document.getElementById('inputText').value = 'A\na\nA';
    executeLineOps('removeDuplicates');
    return document.getElementById('outputText').value === 'A';
  });
  
  test('è¡Œæ“ä½œ - é‡è¤‡è¡Œå‰Šé™¤ - å‰å¾Œã®ç©ºç™½ã‚’ç„¡è¦–ON', () => {
    document.getElementById('dup-case').checked = true;
    document.getElementById('dup-trim').checked = true;
    document.getElementById('dup-keep-order').checked = true;
    document.getElementById('inputText').value = 'a\n a \na';
    executeLineOps('removeDuplicates');
    return document.getElementById('outputText').value === 'a';
  });
  
  test('è¡Œæ“ä½œ - é‡è¤‡è¡Œå‰Šé™¤ - å‡ºç¾é †åºã‚’ä¿æŒOFF', () => {
    document.getElementById('dup-case').checked = true;
    document.getElementById('dup-trim').checked = false;
    document.getElementById('dup-keep-order').checked = false;
    document.getElementById('inputText').value = 'c\na\nb\na';
    executeLineOps('removeDuplicates');
    return document.getElementById('outputText').value === 'a\nb\nc';
  });
  
  // 9. ç©ºè¡Œå‰Šé™¤ï¼ˆè¡Œæ“ä½œã«çµ±åˆï¼‰
  test('è¡Œæ“ä½œ - ç©ºè¡Œå‰Šé™¤ - å®Œå…¨ãªç©ºè¡Œã®ã¿', () => {
    document.getElementById('empty-whitespace').checked = false;
    document.getElementById('inputText').value = 'a\n\nb\n   \nc';
    executeLineOps('removeEmpty');
    return document.getElementById('outputText').value === 'a\nb\n   \nc';
  });
  
  test('è¡Œæ“ä½œ - ç©ºè¡Œå‰Šé™¤ - ç©ºç™½ã®ã¿ã®è¡Œã‚‚å‰Šé™¤', () => {
    document.getElementById('empty-whitespace').checked = true;
    document.getElementById('inputText').value = 'a\n   \nb';
    executeLineOps('removeEmpty');
    return document.getElementById('outputText').value === 'a\nb';
  });
  
  // 10. ç©ºç™½å‰Šé™¤
  test('ç©ºç™½å‰Šé™¤ - ãƒˆãƒªãƒ ã®ã¿', () => {
    document.getElementById('spaces-trim').checked = true;
    document.querySelector('input[name="spaces-remove-mode"][value="none"]').checked = true;
    const result = executeRemoveSpaces('  hello  \n  world  ');
    return result === 'hello\nworld';
  });
  
  test('ç©ºç™½å‰Šé™¤ - é€£ç¶šç©ºç™½ã‚’1ã¤ã«', () => {
    document.getElementById('spaces-trim').checked = false;
    document.querySelector('input[name="spaces-remove-mode"][value="extra"]').checked = true;
    const result = executeRemoveSpaces('a   b    c');
    return result === 'a b c';
  });
  
  test('ç©ºç™½å‰Šé™¤ - ã™ã¹ã¦å‰Šé™¤', () => {
    document.getElementById('spaces-trim').checked = false;
    document.querySelector('input[name="spaces-remove-mode"][value="all"]').checked = true;
    const result = executeRemoveSpaces('a b c');
    return result === 'abc';
  });
  
  test('ç©ºç™½å‰Šé™¤ - ãƒˆãƒªãƒ +é€£ç¶šç©ºç™½ã‚’1ã¤ã«', () => {
    document.getElementById('spaces-trim').checked = true;
    document.querySelector('input[name="spaces-remove-mode"][value="extra"]').checked = true;
    const result = executeRemoveSpaces('  a   b  ');
    return result === 'a b';
  });
  
  // 11. ç©ºç™½è¿½åŠ 
  test('ç©ºç™½è¿½åŠ  - Næ–‡å­—ã”ã¨', () => {
    document.getElementById('spaces-add-every-n').checked = true;
    document.getElementById('spaces-add-n').value = '3';
    document.getElementById('spaces-add-after-char').checked = false;
    document.getElementById('spaces-add-after-line').checked = false;
    const result = executeAddSpacesMain('abcdefghi');
    return result === 'abc def ghi';
  });
  
  test('ç©ºç™½è¿½åŠ  - æŒ‡å®šæ–‡å­—ã®å¾Œ', () => {
    document.getElementById('spaces-add-every-n').checked = false;
    document.getElementById('spaces-add-after-char').checked = true;
    document.getElementById('spaces-after-char').value = '.';
    document.getElementById('spaces-add-after-line').checked = false;
    const result = executeAddSpacesMain('a.b.c');
    return result === 'a. b. c';
  });
  
  test('ç©ºç™½è¿½åŠ  - å„è¡Œæœ«å°¾', () => {
    document.getElementById('spaces-add-every-n').checked = false;
    document.getElementById('spaces-add-after-char').checked = false;
    document.getElementById('spaces-add-after-line').checked = true;
    const result = executeAddSpacesMain('a\nb');
    return result === 'a \nb ';
  });
  
  test('ç©ºç™½è¿½åŠ  - è¤‡åˆï¼ˆNæ–‡å­—ã”ã¨+è¡Œæœ«å°¾ï¼‰', () => {
    document.getElementById('spaces-add-every-n').checked = true;
    document.getElementById('spaces-add-n').value = '2';
    document.getElementById('spaces-add-after-char').checked = false;
    document.getElementById('spaces-add-after-line').checked = true;
    const result = executeAddSpacesMain('abcd');
    return result === 'ab cd ';
  });
  
  // 12. æ–‡å­—å¤‰æ›
  test('æ–‡å­—å¤‰æ› - å°æ–‡å­—ã«å¤‰æ›', () => {
    document.getElementById('inputText').value = 'HELLO World';
    executeConvert('lowercase');
    return document.getElementById('outputText').value === 'hello world';
  });
  
  test('æ–‡å­—å¤‰æ› - å¤§æ–‡å­—ã«å¤‰æ›', () => {
    document.getElementById('inputText').value = 'Hello World';
    executeConvert('uppercase');
    return document.getElementById('outputText').value === 'HELLO WORLD';
  });
  
  test('æ–‡å­—å¤‰æ› - ã²ã‚‰ãŒãªâ†’ã‚«ã‚¿ã‚«ãƒŠ', () => {
    document.getElementById('inputText').value = 'ã‚ã„ã†ãˆãŠ';
    executeConvert('hiraToKata');
    return document.getElementById('outputText').value === 'ã‚¢ã‚¤ã‚¦ã‚¨ã‚ª';
  });
  
  test('æ–‡å­—å¤‰æ› - ã‚«ã‚¿ã‚«ãƒŠâ†’ã²ã‚‰ãŒãª', () => {
    document.getElementById('inputText').value = 'ã‚¢ã‚¤ã‚¦ã‚¨ã‚ª';
    executeConvert('kataToHira');
    return document.getElementById('outputText').value === 'ã‚ã„ã†ãˆãŠ';
  });
  
  test('æ–‡å­—å¤‰æ› - å…¨è§’è‹±æ•°â†’åŠè§’è‹±æ•°', () => {
    document.getElementById('inputText').value = 'ï¼¡ï¼¢ï¼£ï¼‘ï¼’ï¼“';
    executeConvert('alphaToFull');
    return document.getElementById('outputText').value === 'ABC123';
  });
  
  test('æ–‡å­—å¤‰æ› - åŠè§’è‹±æ•°â†’å…¨è§’è‹±æ•°', () => {
    document.getElementById('inputText').value = 'ABC123';
    executeConvert('alphaToHalf');
    return document.getElementById('outputText').value === 'ï¼¡ï¼¢ï¼£ï¼‘ï¼’ï¼“';
  });
  
  test('æ–‡å­—å¤‰æ› - å…¨è§’ã‚«ã‚¿ã‚«ãƒŠâ†’åŠè§’ã‚«ã‚¿ã‚«ãƒŠ', () => {
    document.getElementById('inputText').value = 'ã‚¢ã‚¤ã‚¦';
    executeConvert('kataToFull');
    return document.getElementById('outputText').value === 'ï½±ï½²ï½³';
  });
  
  test('æ–‡å­—å¤‰æ› - åŠè§’ã‚«ã‚¿ã‚«ãƒŠâ†’å…¨è§’ã‚«ã‚¿ã‚«ãƒŠ', () => {
    document.getElementById('inputText').value = 'ï½±ï½²ï½³';
    executeConvert('kataToHalf');
    return document.getElementById('outputText').value === 'ã‚¢ã‚¤ã‚¦';
  });
  
  test('æ–‡å­—å¤‰æ› - å…¨è§’â†’åŠè§’ï¼ˆæ··åœ¨ï¼‰', () => {
    document.getElementById('inputText').value = 'ï¼¡ï½‚ï½ƒï¼‘ï¼’ï¼“';
    executeConvert('toFullwidth');
    return document.getElementById('outputText').value === 'Abc123';
  });
  
  test('æ–‡å­—å¤‰æ› - åŠè§’â†’å…¨è§’ï¼ˆæ··åœ¨ï¼‰', () => {
    document.getElementById('inputText').value = 'Abc123';
    executeConvert('toHalfwidth');
    return document.getElementById('outputText').value === 'ï¼¡ï½‚ï½ƒï¼‘ï¼’ï¼“';
  });
  
  test('æ–‡å­—å¤‰æ› - TABâ†’ç©ºç™½', () => {
    document.getElementById('inputText').value = 'a\tb';
    document.getElementById('convert-tab-spaces').value = '4';
    executeConvert('tabToSpace');
    return document.getElementById('outputText').value === 'a    b';
  });
  
  test('æ–‡å­—å¤‰æ› - ç©ºç™½â†’TAB', () => {
    document.getElementById('inputText').value = 'a    b';
    document.getElementById('convert-tab-spaces').value = '4';
    executeConvert('spaceToTab');
    return document.getElementById('outputText').value === 'a\tb';
  });
  
  test('æ–‡å­—å¤‰æ› - TABâ†’ç©ºç™½ï¼ˆã‚¹ãƒšãƒ¼ã‚¹æ•°å¤‰æ›´ï¼‰', () => {
    document.getElementById('inputText').value = 'a\tb';
    document.getElementById('convert-tab-spaces').value = '2';
    executeConvert('tabToSpace');
    return document.getElementById('outputText').value === 'a  b';
  });
  
  // 13. è¡Œæ“ä½œ
  test('è¡Œæ“ä½œ - å·¦ã®ç©ºç™½ã‚’å‰Šé™¤', () => {
    document.getElementById('inputText').value = '  hello\n  world';
    executeLineOps('trimLeft');
    return document.getElementById('outputText').value === 'hello\nworld';
  });
  
  test('è¡Œæ“ä½œ - å³ã®ç©ºç™½ã‚’å‰Šé™¤', () => {
    document.getElementById('inputText').value = 'hello  \nworld  ';
    executeLineOps('trimRight');
    return document.getElementById('outputText').value === 'hello\nworld';
  });
  
  test('è¡Œæ“ä½œ - å·¦ã®ç©ºç™½ã‚’å‰Šé™¤ï¼ˆå…¨è§’ç©ºç™½ï¼‰', () => {
    document.getElementById('inputText').value = 'ã€€ã€€hello';
    executeLineOps('trimLeft');
    return document.getElementById('outputText').value === 'hello';
  });
  
  test('è¡Œæ“ä½œ - å³ã®ç©ºç™½ã‚’å‰Šé™¤ï¼ˆå…¨è§’ç©ºç™½ï¼‰', () => {
    document.getElementById('inputText').value = 'helloã€€ã€€';
    executeLineOps('trimRight');
    return document.getElementById('outputText').value === 'hello';
  });
  
  test('è¡Œæ“ä½œ - æ˜‡é †ã‚½ãƒ¼ãƒˆï¼ˆæ–‡å­—åˆ—ï¼‰', () => {
    document.getElementById('sort-numeric').checked = false;
    document.getElementById('inputText').value = 'c\na\nb';
    executeLineOps('sortAsc');
    return document.getElementById('outputText').value === 'a\nb\nc';
  });
  
  test('è¡Œæ“ä½œ - é™é †ã‚½ãƒ¼ãƒˆï¼ˆæ–‡å­—åˆ—ï¼‰', () => {
    document.getElementById('sort-numeric').checked = false;
    document.getElementById('inputText').value = 'a\nc\nb';
    executeLineOps('sortDesc');
    return document.getElementById('outputText').value === 'c\nb\na';
  });
  
  test('è¡Œæ“ä½œ - æ•°å€¤æ˜‡é †ã‚½ãƒ¼ãƒˆ', () => {
    document.getElementById('sort-numeric').checked = true;
    document.getElementById('inputText').value = '1\n10\n2\n15\n3';
    executeLineOps('sortAsc');
    return document.getElementById('outputText').value === '1\n2\n3\n10\n15';
  });
  
  test('è¡Œæ“ä½œ - æ•°å€¤é™é †ã‚½ãƒ¼ãƒˆ', () => {
    document.getElementById('sort-numeric').checked = true;
    document.getElementById('inputText').value = '1\n10\n2\n15\n3';
    executeLineOps('sortDesc');
    return document.getElementById('outputText').value === '15\n10\n3\n2\n1';
  });
  
  test('è¡Œæ“ä½œ - æ—¥æœ¬èªã‚½ãƒ¼ãƒˆ', () => {
    document.getElementById('sort-numeric').checked = false;
    document.getElementById('inputText').value = 'ã‹\nã‚\nã•';
    executeLineOps('sortAsc');
    return document.getElementById('outputText').value === 'ã‚\nã‹\nã•';
  });
  
  test('è¡Œæ“ä½œ - uniq (é€£ç¶šé‡è¤‡å‰Šé™¤)', () => {
    document.getElementById('inputText').value = 'a\na\nb\nb\na';
    executeLineOps('uniq');
    return document.getElementById('outputText').value === 'a\nb\na';
  });
  
  // çµæœã‚µãƒãƒªãƒ¼
  console.log('========================================');
  console.log(`ãƒ†ã‚¹ãƒˆå®Œäº†: ${passed} æˆåŠŸ, ${failed} å¤±æ•—`);
  console.log('========================================');
  
  return { passed, failed };
}

// ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã‹ã‚‰å®Ÿè¡Œã§ãã‚‹ã‚ˆã†ã«ã‚°ãƒ­ãƒ¼ãƒãƒ«ã«å…¬é–‹
window.runAllTests = runAllTests;
</script>
</body>
</html>
